<html>
<title> Clase - instrumente virtuale </title>
<body>
<a name="start"></a>
<table width="100%">
<tr><td height="50" background="../../Images/imm_s.bmp"><center><font color= "white" size=5>Realizarea de clase care descriu instrumente virtuale </Center></TD></TR>
</table>
<font color= "Blue" size=5> Instrumente virtuale </font>
<a name="i_virt"></a>
<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color= "Red" size=5>Instrumente virtuale pentru valori instantanee</font>
<a name="termo_virt"></a>
<br><br><li><font color= "Blue" size=4> Instrument virtual - termometru </font>
<br><br><b>C#</b> Aplicatia <font color="red"><b>"Oop_instr_20" </b></font>
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>

namespace Oop_instr_20
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public System.Drawing.Pen creion_albastru;
        public System.Drawing.Pen creion_gri;
        public System.Drawing.SolidBrush radiera;
        public System.Drawing.SolidBrush pensula_rosie;
        public System.Drawing.Font font_nina;
        public termo instr;
        public System.Random nr;

        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            creion_albastru = new System.Drawing.Pen(System.Drawing.Color.Blue);
            creion_gri = new System.Drawing.Pen(System.Drawing.Color.Gray);
            radiera = new System.Drawing.SolidBrush(this.BackColor);
            pensula_rosie = new System.Drawing.SolidBrush(System.Drawing.Color.Red);
            font_nina = new System.Drawing.Font("Nina", 8);
            nr = new System.Random();
            instr = new termo();
            instr.init_ins(100, 20, 10, 150, 1500);
        }

        private void Form1_Paint(object sender, PaintEventArgs e)
        {
            instr.desenez(desen, creion_albastru, creion_gri, pensula_rosie,font_nina);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            instr.sterg(desen, radiera);
            instr.setval(nr.Next(1500), desen, pensula_rosie);
        }
    }

    public class termo
    {
        float x0;
        float y0;
        float w;
        float h;
        float val_max;
        public void desenez(System.Drawing.Graphics zona_des, System.Drawing.Pen creion_a, System.Drawing.Pen creion_gr,System.Drawing.SolidBrush pens_r,System.Drawing.Font font_ni)
        {
            zona_des.DrawRectangle(creion_a, x0, y0, w, h);
            for (int j = 0; j <= h; j += 5)// desenez gradatii
            {
                if (j % 25 == 0)
                {
                    zona_des.DrawLine(creion_gr, x0 + w + 2, y0 + j, x0 + w + 12, y0 + j);
                    zona_des.DrawString(System.Convert.ToString(val_max - j * val_max / h), font_ni, pens_r, x0 + w + 20, y0 + j - 7);
                }
                else
                {
                    zona_des.DrawLine(creion_gr, x0 + w + 2, y0 + j, x0 + w + 7, y0 + j);
                }
            }



        }
        public void sterg(System.Drawing.Graphics zona_des, System.Drawing.SolidBrush rad)
        {
            zona_des.FillRectangle(rad, x0 + 1, y0 + 1, w - 1, h - 1);
        }

        public void setval(float val, System.Drawing.Graphics zona_des, System.Drawing.SolidBrush pens_r)
        {
            val = System.Convert.ToInt16(System.Convert.ToDouble(val) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max))); //scalare
            zona_des.FillRectangle(pens_r, x0 + 1, y0+h-val, w - 1, val);

        }
        public void init_ins(float pozx, float pozy, float lat, float inalt, float vmax)
        {
            x0 = pozx;
            y0 = pozy;
            w = lat;
            h = inalt;
            val_max = vmax;
        }
    }
}

</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp82.gif"></center>
<br><br><b>C#</b> Aplicatia <font color="red"><b>"Oop_instr_21" </b></font>
<br><br>- mai multe obiecte : Mai multe obiecte de tip  : instrument virtual
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>

namespace Oop_instr_21
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public System.Drawing.Pen creion_albastru;
        public System.Drawing.Pen creion_gri;
        public System.Drawing.SolidBrush radiera;
        public System.Drawing.SolidBrush pensula_rosie;
        public System.Drawing.Font font_nina;
        public termo instr_1;
        public termo instr_2;
        public termo instr_3;
        public termo instr_4;
        public System.Random nr;
        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            creion_albastru = new System.Drawing.Pen(System.Drawing.Color.Blue);
            creion_gri = new System.Drawing.Pen(System.Drawing.Color.Gray);
            radiera = new System.Drawing.SolidBrush(this.BackColor);
            pensula_rosie = new System.Drawing.SolidBrush(System.Drawing.Color.Red);
            font_nina = new System.Drawing.Font("Nina", 8);
            nr = new System.Random();
            instr_1 = new termo();
            instr_1.init_ins(100, 20, 15, 150, 1500);
            instr_2 = new termo();
            instr_2.init_ins(200, 40, 10, 100, 500);
            instr_3 = new termo();
            instr_3.init_ins(300, 100, 7, 50, 50);
            instr_4 = new termo();
            instr_4.init_ins(400, 10, 20, 200, 225);
        }

        private void Form1_Paint(object sender, PaintEventArgs e)
        {
            instr_1.desenez(desen, creion_albastru, creion_gri, pensula_rosie, font_nina);
            instr_2.desenez(desen, creion_albastru, creion_gri, pensula_rosie, font_nina);
            instr_3.desenez(desen, creion_albastru, creion_gri, pensula_rosie, font_nina);
            instr_4.desenez(desen, creion_albastru, creion_gri, pensula_rosie, font_nina);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            instr_1.sterg(desen, radiera);
            instr_1.setval(nr.Next(1500), desen, pensula_rosie);
            instr_2.sterg(desen, radiera);
            instr_2.setval(nr.Next(500), desen, pensula_rosie);
            instr_3.sterg(desen, radiera);
            instr_3.setval(nr.Next(50), desen, pensula_rosie);
            instr_4.sterg(desen, radiera);
            instr_4.setval(nr.Next(225), desen, pensula_rosie);
        }
    }
    public class termo
    {
        float x0;
        float y0;
        float w;
        float h;
        float val_max;
        public void desenez(System.Drawing.Graphics zona_des, System.Drawing.Pen creion_a, System.Drawing.Pen creion_gr, System.Drawing.SolidBrush pens_r, System.Drawing.Font font_ni)
        {
            zona_des.DrawRectangle(creion_a, x0, y0, w, h);
            for (int j = 0; j <= h; j += 5)// desenez gradatii
            {
                if (j % 25 == 0)
                {
                    zona_des.DrawLine(creion_gr, x0 + w + 2, y0 + j, x0 + w + 12, y0 + j);
                    zona_des.DrawString(System.Convert.ToString(val_max - j * val_max / h), font_ni, pens_r, x0 + w + 20, y0 + j - 7);
                }
                else
                {
                    zona_des.DrawLine(creion_gr, x0 + w + 2, y0 + j, x0 + w + 7, y0 + j);
                }
            }

        }
        public void sterg(System.Drawing.Graphics zona_des, System.Drawing.SolidBrush rad)
        {
            zona_des.FillRectangle(rad, x0 + 1, y0 + 1, w - 1, h - 1);
        }

        public void setval(float val, System.Drawing.Graphics zona_des, System.Drawing.SolidBrush pens_r)
        {
            val = System.Convert.ToInt16(System.Convert.ToDouble(val) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max))); //scalare
            zona_des.FillRectangle(pens_r, x0 + 1, y0 + h - val, w - 1, val);

        }
        public void init_ins(float pozx, float pozy, float lat, float inalt, float vmax)
        {
            x0 = pozx;
            y0 = pozy;
            w = lat;
            h = inalt;
            val_max = vmax;
        }
    }
}

</pre> </font>
</td></tr></table>


<a name="volt_virt"></a>
<br><br><li><font color= "Blue" size=4> Instrument virtual - voltmetru </font>

<br><br>
&nbsp;&nbsp;&nbsp;&nbsp; Vom crea o clasa instrument de masura analogic denumita "voltm" dupa care vom realza un obiect  prin instantierea clasei voltm
<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Pornim de la aplicatia clasica ce simuleaza un voltmetru.
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace instrum_0
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public System.Drawing.Pen creion_albastru;
        public System.Drawing.SolidBrush radiera;
        System.Random nr;
        float x0=50;
        float y0=40;
        float w=140;
        float h=100;
        float val_max=220;
        float val;
        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            creion_albastru = new System.Drawing.Pen(System.Drawing.Color.Blue);
            radiera = new System.Drawing.SolidBrush(this.BackColor);
            nr = new System.Random();
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            desen.FillRectangle(radiera, x0 + 1, y0 + 1, w - 1, h - 1);
            desen.DrawRectangle(creion_albastru, x0, y0, w, h);
            val = nr.Next(System.Convert.ToInt16(val_max));
            val = System.Convert.ToInt16(System.Convert.ToDouble(val) * (System.Convert.ToDouble(w) / System.Convert.ToDouble(val_max))); //scalare
            desen.DrawLine(creion_albastru, (x0 + w / 2), h + y0, val + x0, y0 + 10);

        }
    }
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp131.jpg"></center><br>
&nbsp;&nbsp;&nbsp;&nbsp; Creem acum o clasa instrument de masura analogic denumita "voltm" si o instantiem.

<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_00
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public System.Drawing.Pen creion_albastru;
        public System.Drawing.SolidBrush radiera;
        public voltm instr;
        System.Random nr;

        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            creion_albastru = new System.Drawing.Pen(System.Drawing.Color.Blue);
            radiera = new System.Drawing.SolidBrush(this.BackColor);
            nr = new System.Random();
            instr = new voltm();
            instr.init_ins(100,100,100,75,1500);
        }
       private void Form1_Paint(object sender, PaintEventArgs e)
        {
            instr.desenez(desen, creion_albastru);
        }
        private void timer1_Tick(object sender, EventArgs e)
        {
            instr.sterg(desen, radiera);
            instr.setval(nr.Next(1500),desen, creion_albastru);
        }
    }
    public class voltm
    {
        float x0;
        float y0;
        float w;
        float h;
        float val_max;
        public void desenez(System.Drawing.Graphics zona_des, System.Drawing.Pen creion_a)
        {
            zona_des.DrawRectangle(creion_a, x0, y0, w, h);
        }
        public void sterg(System.Drawing.Graphics zona_des, System.Drawing.Brush rad)
        {
            zona_des.FillRectangle(rad, x0+1, y0+1, w-1, h-1);
        }

        public void setval(float val, System.Drawing.Graphics zona_des, System.Drawing.Pen creion)
        {
            val = System.Convert.ToInt16(System.Convert.ToDouble(val) * (System.Convert.ToDouble(w) / System.Convert.ToDouble(val_max))); //scalare
            zona_des.DrawLine(creion, (x0 + w / 2), h + y0, val + x0, y0 + 10);
 
        }
        public void init_ins(float pozx, float pozy, float lat,float inalt,float vmax)
        {
            x0=pozx;  
            y0=pozy;
            w=lat;
            h=inalt;
            val_max = vmax;
        }
    }
}</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp120.jpg"></center><br>
<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Putem rescrie clasa "voltm" folosind un constructor. Aplicatia devine: 
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_000
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public System.Drawing.Pen creion_albastru;
        public System.Drawing.SolidBrush radiera;
        public voltm instr;
        System.Random nr;
        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            creion_albastru = new System.Drawing.Pen(System.Drawing.Color.Blue);
            radiera = new System.Drawing.SolidBrush(this.BackColor);
            nr = new System.Random();
            instr = new voltm(100, 100, 100, 75, 1500);

        }

      private void Form1_Paint(object sender, PaintEventArgs e)
        {
            instr.desenez(desen, creion_albastru);
        }
        private void timer1_Tick(object sender, EventArgs e)
        {
            instr.sterg(desen, radiera);
            instr.setval(nr.Next(1500), desen, creion_albastru);
        }
    }
    public class voltm
    {
        float x0;
        float y0;
        float w;
        float h;
        float val_max;
        public void desenez(System.Drawing.Graphics zona_des, System.Drawing.Pen creion_a)
        {
            zona_des.DrawRectangle(creion_a, x0, y0, w, h);
        }
        public void sterg(System.Drawing.Graphics zona_des, System.Drawing.Brush rad)
        {
            zona_des.FillRectangle(rad, x0 + 1, y0 + 1, w - 1, h - 1);
        }

        public void setval(float val, System.Drawing.Graphics zona_des, System.Drawing.Pen creion)
        {
            val = System.Convert.ToInt16(System.Convert.ToDouble(val) * (System.Convert.ToDouble(w) / System.Convert.ToDouble(val_max))); //scalare
            zona_des.DrawLine(creion, (x0 + w / 2), h + y0, val + x0, y0 + 10);

        }
        public voltm(float pozx, float pozy, float lat, float inalt, float vmax)
        {
            x0 = pozx;
            y0 = pozy;
            w = lat;
            h = inalt;
            val_max = vmax;
        }
    }
}

</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->

<br><br>&nbsp;&nbsp;&nbsp;&nbsp; Pe baza clasei  "voltm"  creata anterior, vom realiza mai multe obiecte prin instantierea clasei voltm
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_01
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public System.Drawing.Pen creion_albastru;
        public System.Drawing.SolidBrush radiera;
        public voltm instr_1;
        public voltm instr_2;
        public voltm instr_3;
        System.Random nr;
        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            creion_albastru = new System.Drawing.Pen(System.Drawing.Color.Blue);
            radiera = new System.Drawing.SolidBrush(this.BackColor);
            nr = new System.Random();
            instr_1 = new voltm();
            instr_1.init_ins(100, 50, 100, 75, 1500);
            instr_2 = new voltm();
            instr_2.init_ins(300, 75, 80, 100, 20);
            instr_3 = new voltm();
            instr_3.init_ins(100, 150, 180, 100, 400);
        }

        private void Form1_Paint(object sender, PaintEventArgs e)
        {
            instr_1.desenez(desen, creion_albastru);
            instr_2.desenez(desen, creion_albastru);
            instr_3.desenez(desen, creion_albastru);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            instr_1.sterg(desen, radiera);
            instr_1.setval(nr.Next(1500), desen, creion_albastru);
            instr_2.sterg(desen, radiera);
            instr_2.setval(nr.Next(20), desen, creion_albastru);
            instr_3.sterg(desen, radiera);
            instr_3.setval(nr.Next(400), desen, creion_albastru);
        }
    }
    public class voltm
    {
        float x0;
        float y0;
        float w;
        float h;
        float val_max;
        public void desenez(System.Drawing.Graphics zona_des, System.Drawing.Pen creion_a)
        {
            zona_des.DrawRectangle(creion_a, x0, y0, w, h);
        }
        public void sterg(System.Drawing.Graphics zona_des, System.Drawing.Brush rad)
        {
            zona_des.FillRectangle(rad, x0 + 1, y0 + 1, w - 1, h - 1);
        }

        public void setval(float val, System.Drawing.Graphics zona_des, System.Drawing.Pen creion)
        {
            val = System.Convert.ToInt16(System.Convert.ToDouble(val) * (System.Convert.ToDouble(w) / System.Convert.ToDouble(val_max))); //scalare
            zona_des.DrawLine(creion, (x0 + w / 2), h + y0, val + x0, y0 + 10);

        }
        public void init_ins(float pozx, float pozy, float lat, float inalt, float vmax)
        {
            x0 = pozx;
            y0 = pozy;
            w = lat;
            h = inalt;
            val_max = vmax;
        }
    }
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp121.jpg"></center><br>

<br><br>&nbsp;&nbsp;&nbsp;&nbsp; Vom modifica clasa instrument de masura analogic denumita "voltm" si vom realiza mai multe obiecte prin instantierea clasei voltm nou creata
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_02
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        System.Drawing.Graphics Desen;
        System.Drawing.Pen Creion_rosu;
        System.Drawing.SolidBrush Pens_blu;
        System.Drawing.SolidBrush Pens_back;
        public voltm voltm1;
        public voltm voltm2;
        public voltm voltm3;

        System.Random nr;
        int alfa;

        public class voltm
        {
            int x0;
            int y0;
            int w;
            int h;

            public void setval(System.Drawing.Graphics zona_des, System.Drawing.Pen creion, System.Drawing.SolidBrush radiera, int alfa_gr)
            {
                // alfa_gr unghiul in grade
                int xc = x0 + w / 2;
                int yc = y0 + w / 2;
                int raza = w / 2;
                zona_des.FillEllipse(radiera, x0, y0, w, w);

                double alfa_r = 2 * System.Math.PI * (alfa_gr) / 360;// unghiul in radiani
                int x = System.Convert.ToInt16(xc + raza * System.Math.Cos(alfa_r));
                int y = System.Convert.ToInt16(yc - raza * System.Math.Sin(alfa_r));
                zona_des.DrawRectangle(creion, xc - raza, yc - raza, 2 * raza, 5 * raza / 4);
                zona_des.DrawArc(creion, xc - raza, yc - raza, 2 * raza, 2 * raza, -30, -120);
                zona_des.DrawLine(creion, x, y, xc, yc);
            }

            public void init_voltm(int pozx, int pozy, int lat, int inalt)
            {
                x0 = pozx;
                y0 = pozy;
                w = lat;
                h = inalt;
            }
        } 
        private void Form1_Load(object sender, EventArgs e)
        {
            Creion_rosu = new System.Drawing.Pen(System.Drawing.Color.Red);
            Pens_blu = new System.Drawing.SolidBrush(System.Drawing.Color.Blue);
            Pens_back = new System.Drawing.SolidBrush(this.BackColor);
            Desen = this.CreateGraphics();
            nr = new System.Random();
            voltm1 = new voltm();
            voltm1.init_voltm(10, 100, 100, 75);
            voltm2 = new voltm();
            voltm2.init_voltm(200, 50, 120, 55);
            voltm3 = new voltm();
            voltm3.init_voltm(150, 200, 50, 175);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            voltm1.setval(Desen, Creion_rosu, Pens_back, alfa);
            voltm2.setval(Desen, Creion_rosu, Pens_back, alfa);
            voltm3.setval(Desen, Creion_rosu, Pens_back, alfa);
            alfa -= 7;
            if (alfa < 40)
                alfa = 140;
        }
    }
}
</pre> </font>
</td></tr></table>
<!-------------------------------------------------------------------> 
<br><br><center><img src="im_cpp124.jpg"></center><br>
<br><br>&nbsp;&nbsp;&nbsp;&nbsp; Modificam din nou clasa instrument de masura analogic denumita "voltm" dupa care realizam mai multe obiecte prin instantierea clasei voltm.
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_03
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        System.Drawing.Graphics Desen;
        System.Drawing.Pen Creion_rosu;
        System.Drawing.SolidBrush Pens_blu;
        System.Drawing.SolidBrush Pens_back;
        public voltm voltm1;
        public voltm voltm2;
        public voltm voltm3;

        System.Random nr;
        int alfa;

        public class voltm
        {
            int x0;
            int y0;
            int w;
            public void desen_voltm(System.Drawing.Graphics zona_des, System.Drawing.Pen creion, System.Drawing.SolidBrush radiera)
            { 
                int lg = 5;
                int x1, x2, y1, y2;
                int xc = x0 + w / 2;
                int yc = y0 + w / 2;
                int raza = w / 2;
                int nrd;
                // alfa_gr unghiul in grade
                double alfa_gr = 40;
                nrd = 0;
                while (alfa_gr <= 140)
                {
                    double alfa_r = 2 * System.Math.PI * (alfa_gr) / 360;// unghiul in radiani
                    if (nrd % 5 == 0)
                    {
                        x1 = System.Convert.ToInt16(xc + raza * System.Math.Cos(alfa_r));
                        y1 = System.Convert.ToInt16(yc - raza * System.Math.Sin(alfa_r));
                    }
                    else
                    {
                        x1 = System.Convert.ToInt16(xc + (raza - lg) * System.Math.Cos(alfa_r));
                        y1 = System.Convert.ToInt16(yc - (raza - lg) * System.Math.Sin(alfa_r));

                    }
                    x2 = System.Convert.ToInt16(xc + (raza - 2 * lg) * System.Math.Cos(alfa_r));
                    y2 = System.Convert.ToInt16(yc - (raza - 2 * lg) * System.Math.Sin(alfa_r));
                    zona_des.DrawLine(creion, x1, y1, x2, y2);
                    alfa_gr += 2;
                    nrd++;
                }
                zona_des.DrawRectangle(creion, xc - raza, yc - raza - 2, 2 * raza, 5 * raza / 4);
            }
            public void setval(System.Drawing.Graphics zona_des, System.Drawing.Pen creion, System.Drawing.SolidBrush radiera, int alfa_gr)
            {
                // alfa_gr unghiul in grade
                int lg = 5;
                int xc = x0 + w / 2;
                int yc = y0 + w / 2;
                int raza = w / 2;
                zona_des.FillPie(radiera, x0 + 2 * lg-1, y0 + 2 * lg-1, w - 4 * lg+2, w - 4 * lg+2, 10, -180);
                double alfa_r = 2 * System.Math.PI * (alfa_gr) / 360;// unghiul in radiani
                int x = System.Convert.ToInt16(xc + (raza-2*lg) * System.Math.Cos(alfa_r));
                int y = System.Convert.ToInt16(yc - (raza-2*lg) * System.Math.Sin(alfa_r));
                zona_des.DrawLine(creion, x, y, xc, yc);
                alfa_gr = 40;
                zona_des.DrawRectangle(creion, xc - raza, yc - raza-2, 2 * raza, 5 * raza / 4);        
            }

            public void init_voltm(int pozx, int pozy, int lat)
            {
                x0 = pozx;
                y0 = pozy;
                w = lat;
            }
        } 
        private void Form1_Load(object sender, EventArgs e)
        {
            Creion_rosu = new System.Drawing.Pen(System.Drawing.Color.Red);
            Pens_blu = new System.Drawing.SolidBrush(System.Drawing.Color.Blue);
            Pens_back = new System.Drawing.SolidBrush(this.BackColor);
            Desen = this.CreateGraphics();
            nr = new System.Random();
            voltm1 = new voltm();
            voltm1.init_voltm(10, 10, 290);
            voltm2 = new voltm();
            voltm2.init_voltm(320, 155, 220);
            voltm3 = new voltm();
            voltm3.init_voltm(550, 30, 150);
        }
        private void Form1_Paint(object sender, PaintEventArgs e)
        {
            voltm1.desen_voltm(Desen, Creion_rosu, Pens_back);
            voltm2.desen_voltm(Desen, Creion_rosu, Pens_back);
            voltm3.desen_voltm(Desen, Creion_rosu, Pens_back);
        }
        private void timer1_Tick(object sender, EventArgs e)
        {
            voltm1.setval(Desen, Creion_rosu, Pens_back, alfa);
            voltm2.setval(Desen, Creion_rosu, Pens_back, alfa);
            voltm3.setval(Desen, Creion_rosu, Pens_back, alfa);
            alfa -= 7;
            if (alfa < 40)
                alfa = 140;
        }
    }
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp126.jpg"></center><br>

<!------------------------------------------------------------------->
<br>&nbsp;&nbsp;&nbsp;&nbsp; Adugam clasei voltm facilitati pentru afisarea valorilor numerice si totodata vom adauga un 
constructor, ne mai fiind necesara metoda init_voltm. Pentru a usura folosirea clasei, s-au scos facilitatile pentru schimbarea 
culorilor acestea fiind fixate in cadrul clasei. S-a mai introdus parametrul val_max in vederea afisarii valorilor numerice pe voltmetru.
Metoda "setval" are ca parametru "val" adica valoarea parametrului de afisat (intre 0 si val_max), fiind astfel inlocuit parametrul "alfa".
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_04
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        System.Drawing.Graphics Desen;

        public voltm voltm1;
        public voltm voltm2;
        public voltm voltm3;

        System.Random nr;
        double u1,u2,u3;
        double um1 = 500;
        double um2 = 300;
        double um3 = 250;
        public class voltm
        {
            int x0;
            int y0;
            int w;
            double vm;
            System.Drawing.Pen creion= new System.Drawing.Pen(System.Drawing.Color.Red);
            System.Drawing.Font font_ni = new System.Drawing.Font("Nina", 8);
            System.Drawing.SolidBrush pens_blu = new System.Drawing.SolidBrush(System.Drawing.Color.Blue);
            System.Drawing.SolidBrush radiera = new System.Drawing.SolidBrush(System.Drawing.Color.White);

            public void desen_voltm(System.Drawing.Graphics zona_des)
            {
                int lt = 15;
                int lg = 22;
                int x1, x2, xt, y1, y2, yt;
                int xc = x0 + w / 2;
                int yc = y0 + w / 2;
                int raza = w / 2;
                int nrd;
                int val_a=0;
                // alfa_gr unghiul in grade
                double alfa_gr = 140;
                nrd = 0;
                while (alfa_gr >=40)
                {
                    double alfa_r = 2 * System.Math.PI * (alfa_gr) / 360;// unghiul in radiani
                    if (nrd % 5 == 0)
                    {
                        x1 = System.Convert.ToInt16(xc + (raza-lt) * System.Math.Cos(alfa_r));
                        y1 = System.Convert.ToInt16(yc - (raza-lt) * System.Math.Sin(alfa_r));
                        xt = System.Convert.ToInt16(xc-5 + raza * System.Math.Cos(alfa_r));
                        yt = System.Convert.ToInt16(yc - raza * System.Math.Sin(alfa_r));
                        zona_des.DrawString(System.Convert.ToString(val_a), font_ni, pens_blu, xt, yt);
                        val_a = val_a + System.Convert.ToInt16(vm /10);

                    }
                    else
                    {
                        x1 = System.Convert.ToInt16(xc + (raza - lg) * System.Math.Cos(alfa_r));
                        y1 = System.Convert.ToInt16(yc - (raza - lg) * System.Math.Sin(alfa_r));
                    }
                    x2 = System.Convert.ToInt16(xc + (raza - 2 * lt) * System.Math.Cos(alfa_r));
                    y2 = System.Convert.ToInt16(yc - (raza - 2 * lt) * System.Math.Sin(alfa_r));
                    zona_des.DrawLine(creion, x1, y1, x2, y2);
                    alfa_gr -= 2;
                    nrd++;
                }
                zona_des.DrawRectangle(creion, xc - raza, yc - raza - 2, 2 * raza, 5 * raza / 4);
            }
            public void setval(System.Drawing.Graphics zona_des, double val)
            {
                int alfa_gr = 140 - System.Convert.ToInt16(100 * val / vm); ;//unghiul in grade

                int lg = 17;
                int xc = x0 + w / 2;
                int yc = y0 + w / 2;
                int raza = w / 2;
                zona_des.FillPie(radiera, x0 + 2 * lg - 1, y0 + 2 * lg - 1, w - 4 * lg + 2, w - 4 * lg + 2, 10, -180);
                double alfa_r = 2 * System.Math.PI * (alfa_gr) / 360;// unghiul in radiani
                int x = System.Convert.ToInt16(xc + (raza - 2 * lg) * System.Math.Cos(alfa_r));
                int y = System.Convert.ToInt16(yc - (raza - 2 * lg) * System.Math.Sin(alfa_r));
                zona_des.DrawLine(creion, x, y, xc, yc);
                alfa_gr = 40;
                zona_des.DrawRectangle(creion, xc - raza, yc - raza - 2, 2 * raza, 5 * raza / 4);
            }

            public voltm(int pozx, int pozy, int lat, double val_max)
            {
                x0 = pozx;
                y0 = pozy;
                w = lat;
                vm = val_max;
            }
        } 

        private void Form1_Load(object sender, EventArgs e)
        {
            Desen = this.CreateGraphics();
            nr = new System.Random();
            voltm1 = new voltm(10, 10, 290,um1);
            voltm2 = new voltm(320, 160, 220,um2);
            voltm3 = new voltm(370, 20, 200,um3);
        }

        private void Form1_Paint(object sender, PaintEventArgs e)
        {
            voltm1.desen_voltm(Desen);
            voltm2.desen_voltm(Desen);
            voltm3.desen_voltm(Desen);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            if (u1 > um1)
                u1 = 0;
            voltm1.setval(Desen, u1);
            u1 += 10;
            if (u2 > um2)
                u2 = 0;
            voltm2.setval(Desen, u2);
            u2 += 25;
            if (u3 > um3)
                u3 = 0;
            voltm3.setval(Desen, u3);
            u3 += 25;
        }
    }
}

</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp127.jpg"></center><br>

<br>&nbsp;&nbsp;&nbsp;&nbsp;In loc sa desenam gradatii si valori am putea incarca o imagine a unui voltmetu.
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_06
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        System.Drawing.Graphics Desen;
        System.Random nr;
        public voltm voltm1;
        double u1,um=250;
        private void Form1_Load(object sender, EventArgs e)
        {
            Desen = this.CreateGraphics();
            nr = new System.Random();
            //voltm1 = new voltm(10, 10, um,"e:\\voltm.jpg");
            voltm1 = new voltm(10, 10, um, "voltm.jpg");
        }
        private void timer1_Tick(object sender, EventArgs e)
        {
            if (u1 > um)
                u1 = 0;
            voltm1.setval(Desen, u1);
            u1 += 10;
        }
    // Clasa voltmetru
        public class voltm
        {
            System.Drawing.Pen creion = new System.Drawing.Pen(System.Drawing.Color.Red);
            System.Drawing.Font font_ni = new System.Drawing.Font("Nina", 14);
            System.Drawing.SolidBrush pens_blu = new System.Drawing.SolidBrush(System.Drawing.Color.Blue);
            System.Drawing.Bitmap img;
            System.Drawing.Bitmap ims;
            int x0,y0,w,h;
            double vm;
            public void setval(System.Drawing.Graphics zona_des, double val)
            {
                int alfa_gr = 140 - System.Convert.ToInt16(100 * val / vm); ;//unghiul in grade
                int lg = 5;
                int xc = w / 2;
                int yc = h-20;
                int raza = 3*w / 5;
                img = new Bitmap(ims);
                Graphics g = Graphics.FromImage(img);
                double alfa_r = 2 * System.Math.PI * (alfa_gr) / 360;// unghiul in radiani
                int x = System.Convert.ToInt16(xc + (raza - 2 * lg) * System.Math.Cos(alfa_r));
                int y = System.Convert.ToInt16(yc - (raza - 2 * lg) * System.Math.Sin(alfa_r));
                g.DrawLine(creion, x, y, xc, yc);
                alfa_gr = 40;
                g.DrawString(val.ToString(),font_ni, pens_blu,0,0);
                zona_des.DrawImage(img, x0, y0);
            }
            public voltm(int pozx, int pozy, double vmax, string fisier_img)
            {
                x0 = pozx;
                y0 = pozy;
                vm = vmax;
                ims = new Bitmap(fisier_img);
                w = ims.Width;
                h = ims.Height;
            }
        }
    // gata clasa voltmetru
    }
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp93.gif"></center><br>


<a name="anem"></a>
<br><br><li><font color= "Blue" size=4> Instrument virtual - anemometru </font>
<!------------------------------------------------------------------->
<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Vom realiza acum un instrument pentru masurarea directiei si intensitatii vantului.
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_07
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public anemom anemom1;
        public System.Random n;
        int pozx = 50, pozy = 30, diam = 280;
        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            n = new System.Random();
            anemom1 = new anemom(pozx, pozy, diam);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            anemom1.setval(desen, n.Next(diam / 2), n.Next(360));
        }
        // --------------Clasa anemometru ------------------

        public class anemom
        {
            int x0, y0, w, val;
            int r, rc, ds, d, xm, ym, xv, yv, xc, yc;
            double ar, a, ai;
            System.Drawing.Graphics zona_des;
            System.Drawing.Pen creion_a = new System.Drawing.Pen(System.Drawing.Color.Gray);
            System.Drawing.Pen creion_r = new System.Drawing.Pen(System.Drawing.Color.Red);

            public void setval(System.Drawing.Graphics desen,int i_vant, int dir_v)
            {
                zona_des = desen;
                r = w / 2 - 1;
                ds = 2 * r / 9; // distanta dintre cercuri
                xc = x0+r;
                yc = y0+r;
                rc = 0;
                val = i_vant;
                ai = dir_v;
                // sterg
                zona_des.Clear(Color.White);

                // pun grid

                // cercuri concentrice
                rc = 0;
                for (d = 2 * r; d >= 0; d -= ds)
                {
                    zona_des.DrawEllipse(creion_a, rc+x0, rc+y0, d, d);
                    rc += ds / 2;
                }

                //raze in cerc

                for (a = 0; a < 360; a += 360 / 12)
                {
                     ar = a * Math.PI / 180;
                     xm = System.Convert.ToInt16(xc + r * Math.Sin(ar));
                     ym = System.Convert.ToInt16(yc - r * Math.Cos(ar));
                     zona_des.DrawLine(creion_a, xc, yc, xm, ym);
                }

                // fascicul de raze
                for (a = ai; a < (ai + 30); a += 360 / 120)
                {
                     ar = a * Math.PI / 180;
                     xm = System.Convert.ToInt16(xc + r * Math.Sin(ar));
                     ym = System.Convert.ToInt16(yc - r * Math.Cos(ar));
                     zona_des.DrawLine(creion_a, xc, yc, xm, ym);
                     xv = System.Convert.ToInt16(xc + val * Math.Sin(ar));
                     yv = System.Convert.ToInt16(yc - val * Math.Cos(ar));
                     zona_des.DrawLine(creion_r, xc, yc, xv, yv);
                }
            }
            public anemom(int pozx, int pozy, int diam)
            {
                x0 = pozx;
                y0 = pozy;
                w = diam;
            }
        }
        // --------------Sfarsit clasa anemometru ------------------
    }
}

</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp92.gif"></center><br>
<br>&nbsp;&nbsp;&nbsp;&nbsp;La rularea aplicatiei se observa faptul ca imaginea nu e fixa pe ecran. Imaginea "clipeste" din 
cauza stergerii repetate si redesenarii acesteia la fiecare invocare a metodei "set_val" 
<br>&nbsp;&nbsp;&nbsp;&nbsp;Pentru a elimina acest efect, vom crea la initializare o imagine de fundal <b> ims </b> reprezentand 
"grid-ul" iar la invocarea metodei "set_val" in loc de stergere, vom incarca imaginea <b> ims </b> in imaginea  <b>img</b>, 
dupa care se va desenarea tot in imaginea <b>img</b> fascicolul de raze reprezentand directia si intensitatea vantului. 
Afisarea se va face doar cand imaginea e pregatita folosind declaratia: <b> zona_des.DrawImage(img, x0, y0);</b> 


<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_08
{ 
    public partial class Form1 : Form
    {

        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public anemom anemom1;
        public System.Random n;
        int pozx = 50, pozy = 30, diam = 300;
        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            n = new System.Random();
            anemom1 = new anemom(desen, pozx, pozy, diam);
        }
        private void timer1_Tick(object sender, EventArgs e)
        {
            anemom1.setval(n.Next(diam / 2), n.Next(360));
        }
    }


    // --------------Clasa anemometru ------------------

    public class anemom
    {
        int x0, y0, w, val;
        int r , rc , ds , d, xm, ym, xv, yv, xc, yc, i, j;
        double ar, a,ai;

        System.Drawing.Graphics zona_des;
        System.Drawing.Pen creion_a = new System.Drawing.Pen(System.Drawing.Color.Gray);
        System.Drawing.Pen creion_r = new System.Drawing.Pen(System.Drawing.Color.Red);
        System.Drawing.Bitmap img;
        System.Drawing.Bitmap ims;

        public void setval( int i_vant,int dir_v)
        {
            val = i_vant;
            ai = dir_v;
            if (w > 0)
            {
                // pun grid
                img = new Bitmap(ims);

                // fascicul de raze
                Graphics g = Graphics.FromImage(img);
                for (a = ai; a < (ai + 30); a += 360 / 120)
                {
                    ar = a * Math.PI / 180;
                    xm = System.Convert.ToInt16(xc + r * Math.Sin(ar));
                    ym = System.Convert.ToInt16(yc - r * Math.Cos(ar));
                    g.DrawLine(creion_a, xc, yc, xm, ym);
                    xv = System.Convert.ToInt16(xc + val * Math.Sin(ar));
                    yv = System.Convert.ToInt16(yc - val * Math.Cos(ar));
                    g.DrawLine(creion_r, xc, yc, xv, yv);
                }
            }
            // afisez
            zona_des.DrawImage(img, x0, y0);
        }
        public anemom(System.Drawing.Graphics desen, int pozx, int pozy, int diam)
        {
            x0 = pozx;
            y0 = pozy;
            w = diam;
            r = w / 2 - 1;
            ds = 2 * r / 9; // distanta dintre cercuri
            xc = r;
            yc = r;
            rc = 0;
            double ar, a;
            zona_des = desen;
            img = new Bitmap(w, w, zona_des);
            if (w > 0 )
            {
                ims = new Bitmap(w, w, zona_des);
                Graphics g = Graphics.FromImage(ims);

                // sterg imaginea

                for (j = 0; j < w; j++)
                {
                    for (i = 0; i < w; i++)
                    {
                        ims.SetPixel(i, j, System.Drawing.Color.White);
                    }
                }

                // cercuri concentrice

                rc = 0;
                for (d = 2 * r; d >= 0; d -= ds)
                {
                    g.DrawEllipse(creion_a, rc, rc, d, d);
                    rc += ds / 2;
                }

                //raze in cerc

                for (a = 0; a < 360; a += 360 / 12)
                {
                    ar = a * Math.PI / 180;
                    xm = System.Convert.ToInt16(xc + r * Math.Sin(ar));
                    ym = System.Convert.ToInt16(yc - r * Math.Cos(ar));
                    g.DrawLine(creion_a, xc, yc, xm, ym);
                }
            }
        }
        // --------------Sfarsit clasa anemometru ------------------
    }
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<a name="manom"></a>
<br><br><li><font color= "Blue" size=4> Instrument virtual - manometru </font>
<!------------------------------------------------------------------->
<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Vom realiza acum un instrument pentru masurarea presiunii.

<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_60
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public manom manom1;
        public System.Random n;
        int pozx = 50, pozy = 30, diam = 300, max=500;
        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            n = new System.Random();
            manom1 = new manom(desen, pozx, pozy, diam, max);
        }
        private void timer1_Tick(object sender, EventArgs e)
        {
            manom1.setval(n.Next(diam / 2), n.Next(max));
        }
    }
    // --------------Clasa manometru ------------------

        public class manom
        {
            static int gr = 25; //grosimea arcului de cerc
            int x0, y0, xi, xe, xm, xgr, xgm, xtx, w, val_m, diam_i, diam_e, diam_m, diam_gr, diam_gm, diam_tx;
            
            System.Drawing.Pen creion_lg = new System.Drawing.Pen(System.Drawing.Color.LightGray,gr);
            System.Drawing.Pen creion_rad = new System.Drawing.Pen(System.Drawing.Color.White, gr);
            System.Drawing.Pen creion_g = new System.Drawing.Pen(System.Drawing.Color.Gray);
            System.Drawing.Pen creion_r = new System.Drawing.Pen(System.Drawing.Color.Blue);
            System.Drawing.Font font_arial=new System.Drawing.Font("Arial",12);
            System.Drawing.SolidBrush pens_a = new System.Drawing.SolidBrush(System.Drawing.Color.Blue);
            System.Drawing.SolidBrush pens_r = new System.Drawing.SolidBrush(System.Drawing.Color.Red);
            System.Drawing.SolidBrush pens_rad = new System.Drawing.SolidBrush(System.Drawing.Color.White);
            System.Drawing.Graphics zona_des;
            System.Drawing.Bitmap img;
            Graphics g;
            public void setval(int i_vant, int val)
            {
                int vl = val;
                int alfa = 360 * vl / val_m;
                if (w > 0)
                {
                    // trasez arc de cerc

                    g.DrawArc(creion_rad, xm, xm, diam_m, diam_m, 0, 365);
                    g.DrawArc(creion_lg, xm, xm, diam_m, diam_m, 90, alfa);
                    g.DrawEllipse(creion_g, xi, xi, diam_i, diam_i);
                    g.DrawEllipse(creion_g, xe, xe, diam_e, diam_e);
                    g.FillRectangle(pens_rad, (w - gr) / 2, (w - gr) / 2, 2 * gr, gr);
                    g.DrawString(vl.ToString(), font_arial, pens_r, (w - gr) / 2, (w - gr) / 2);
                }
                // afisez imaginea

                zona_des.DrawImage(img, x0, y0);
            }
            public manom(System.Drawing.Graphics desen, int pozx, int pozy, int diam, int val_max)
            {
                x0 = pozx; // pozitia pe x a instrumentului
                y0 = pozy; // pozitia pe y a instrumentului
                diam_i = diam - 7 * gr; // diametrul cercului interior
                diam_e = diam_i + 2 * gr; // diametrul cercului exterior
                diam_m = (diam_e + diam_i) / 2; // diametrul cercului mediu pentru arcul de cerc
                diam_gr = diam_e + 2 * gr / 3; // diametrul cercului pentru gradatii
                diam_gm = diam_e + 4 * gr / 3; // diametrul cercului pentru gradatii mari
                diam_tx = diam_e + 3 * gr; // diametrul cercului pentru texte
                w = diam; // latimea instrumentului
                val_m = val_max; // valoarea maxima afisata
                xi = (w - diam_i) / 2; // coordonata pentru cercul interior
                xe = (w - diam_e) / 2; // coordonata pentru cercul exterior
                xm = (w - diam_m) / 2; // coordonata pentru cercul mediu
                xgr = (w - diam_gr) / 2; // coordonata pentru cercul gradatiilor mici
                xgm = (w - diam_gm) / 2; // coordonata pentru cercul gradatiilor mari
                xtx = (w - diam_tx) / 2 - gr / 3; // coordonata pentru cercul valorilor
                zona_des = desen;
                img = new Bitmap(w, w, zona_des);
                if (w > 0)
                {
                    g = Graphics.FromImage(img);
                    int k = 0;
                    double grd; // grade hexazecimale
                    for (grd = 630; grd > 270; grd -= 3.6)
                    {
                        double rad = 2 * System.Math.PI * grd / 360;
                        int x1 = Convert.ToInt16(xe + (diam_e / 2)+(diam_e / 2) * System.Math.Cos(rad));
                        int y1 = Convert.ToInt16(xe + (diam_e / 2)-(diam_e / 2) * System.Math.Sin(rad));
                        int x2 = Convert.ToInt16(xgr + (diam_gr / 2) + (diam_gr / 2) * System.Math.Cos(rad));
                        int y2 = Convert.ToInt16(xgr + (diam_gr / 2) - (diam_gr / 2) * System.Math.Sin(rad));
                        int x3 = Convert.ToInt16(xgm + (diam_gm / 2) + (diam_gm / 2) * System.Math.Cos(rad));
                        int y3 = Convert.ToInt16(xgm + (diam_gm / 2) - (diam_gm / 2) * System.Math.Sin(rad));
                        int x4 = Convert.ToInt16(xtx + (diam_tx / 2) + (diam_tx / 2) * System.Math.Cos(rad));
                        int y4 = Convert.ToInt16(xtx + (diam_tx / 2) - (diam_tx / 2) * System.Math.Sin(rad));
                        if (k % 10 != 0)
                        {
                            g.DrawLine(creion_g, x1, y1, x2, y2);         
                        }
                        else
                        {
                            g.DrawLine(creion_r, x1, y1, x3, y3);
                            g.DrawString((k*val_m/100).ToString(), font_arial, pens_a, x4, y4);
                        }
                        k++;
                    }
                }
            }
        // --------------Sfarsit clasa manometru ------------------
    }
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp94.gif"></center>
<a name="ot"></a>
<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color= "Red" size=5>Instrumente virtuale pentru afisarea evolutiei in timp a marimilor electrice </font>
<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Pornim de la clasa <b> afisor_xt </b> folosita in <b>Aplicatia C#</b> <font color="red"><b>"Oop_instr_10" </b></font> pentru afisare grafica
in coordonate x-t.
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_10
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public System.Drawing.Pen creion_albastru;
        public System.Drawing.Pen creion_rosu;
        public System.Drawing.SolidBrush radiera;
        public afisor_xt instr;
        System.Random nr;
        int np = 10;
        int v_max = 300;
        static float[] valori = new float[0];
        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            creion_albastru = new System.Drawing.Pen(System.Drawing.Color.Blue);
            creion_rosu = new System.Drawing.Pen(System.Drawing.Color.Red);
            radiera = new System.Drawing.SolidBrush(this.BackColor);
            nr = new System.Random();
            instr = new afisor_xt();
            instr.init_ins(10, 10, np*10, 200, v_max);
        }

        private void Form1_Paint(object sender, PaintEventArgs e)
        {
            instr.desenez(desen, creion_albastru);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            int nr_max, val_max;

            nr_max = np;
            val_max = v_max;
            instr.sterg(desen, radiera);
            Array.Resize(ref valori, nr_max + 1);
             for(int i=1;i<=nr_max;i++){
                 valori[i]=nr.Next(val_max);
             }
            instr.setval(desen, creion_rosu,valori,nr_max);
        }
    }

    public class afisor_xt
    {
        float x0;
        float y0;
        float w;
        float h;
        float val_max;
        public void desenez(System.Drawing.Graphics zona_des, System.Drawing.Pen creion_a)
        {
            zona_des.DrawRectangle(creion_a, x0, y0, w, h);
        }
        public void sterg(System.Drawing.Graphics zona_des, System.Drawing.Brush rad)
        {
            zona_des.FillRectangle(rad, x0 + 1, y0 + 1, w - 1, h - 1);
        }

        public void setval(System.Drawing.Graphics zona_des, System.Drawing.Pen creion, float[] vals, int nrv)
        {
            float val_v,val;
            val_v = 0;
            for(int i=1;i<=nrv;i++){
                val = System.Convert.ToInt16(System.Convert.ToDouble(vals[i]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max))); //scalare
                zona_des.DrawLine(creion, x0 +(i-1)*10, y0+val_v, x0 +i*10, y0+val);
                val_v=val;
            }
        }
        public void init_ins(float pozx, float pozy, float lat, float inalt, float vmax)
        {
            x0 = pozx;
            y0 = pozy;
            w = lat;
            h = inalt;
            val_max = vmax;
        }
    }
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp110.jpg"></center>

<a name="a_sin"></a>
<ul><li><b> Afisare sinus</b></ul>

&nbsp;&nbsp;&nbsp;&nbsp;Utilizarea clasei afisor_xt pentru afisare grafica in coordonate x-t a functiei sin(x)

<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_12
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public System.Drawing.Pen creion_albastru;
        public System.Drawing.Pen creion_rosu;
        public System.Drawing.Pen creion_pic;
        public System.Drawing.Pen creion_gri_d;
	    public System.Drawing.Pen creion_gri;
        public System.Drawing.SolidBrush radiera;
        public afisor_xt afisor_xt1;
        int pozx = 30, pozy = 10, n_maxx=273, n_maxy=205;
        double alfa = 0;
        double fi = 0;
        static int[] valori = new int[0];
        private void Form1_Load(object sender, EventArgs e)
        {
            Array.Resize(ref valori, n_maxx + 1);
            desen = this.CreateGraphics();
            creion_albastru = new System.Drawing.Pen(System.Drawing.Color.Blue);
            creion_rosu = new System.Drawing.Pen(System.Drawing.Color.Red);
            creion_pic = new System.Drawing.Pen(this.BackColor);
            creion_gri_d = new System.Drawing.Pen(System.Drawing.Color.LightGray); 
            creion_gri = new System.Drawing.Pen(System.Drawing.Color.Gray);
            radiera = new System.Drawing.SolidBrush(this.BackColor);
            afisor_xt1 = new afisor_xt();
            afisor_xt1.init_ins(pozx,pozy,n_maxx,n_maxy);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            fi=fi+0.3;
            alfa = fi;
            for (int i = 1; i <= n_maxx; i++)
            {
                alfa += 0.04;
                valori[i] = System.Convert.ToUInt16(n_maxy/6+((n_maxy/3)*( 1 - Math.Sin(alfa))));
            }
            afisor_xt1.setval(desen, creion_albastru, creion_rosu, creion_gri_d, creion_gri, creion_pic,radiera, valori, n_maxx);
        }
        public class afisor_xt
        {
            int x0;
            int y0;
            int w;
            int h;
            int val_max;
            int nr_max;

            public void setval(System.Drawing.Graphics zona_des, System.Drawing.Pen creion_a, System.Drawing.Pen creion_r, System.Drawing.Pen creion_grd, System.Drawing.Pen creion_gr, System.Drawing.Pen pic,System.Drawing.SolidBrush radiera, int[] vals, int nrv)
            {
                int val_v, val ,i ,j;
                //zona_des.FillRectangle(radiera, x0 + 1, y0 + 1, w - 1, h - 1);
                //chenar
                zona_des.DrawRectangle(creion_a, x0, y0, w+1, h);
                val_v = System.Convert.ToInt16(System.Convert.ToDouble(vals[1]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max)));
                for (i = 1; i < nrv; i++)
                {
                    //grid vertical
                    if ((i + 1) % 10 == 0)
                    {
                        zona_des.DrawLine(creion_grd, i + x0, y0, i + x0, y0 + h);
                        if ((i+1) % 50 == 0)
                            zona_des.DrawLine(creion_gr, i + x0, y0, i + x0, y0 + h);
                    }
                    else
                        zona_des.DrawLine(pic, x0 + 1, y0 + 1, x0 + 1, y0 + h - 2);
                    // grid orizontal
                    j = y0+10;
                    while (j <= h)
                    {
                        if (j % 50 == 0)
                            zona_des.DrawLine(creion_gr, i + x0, j, i+x0+1, j);
                       else
                            zona_des.DrawLine(creion_grd, i + x0, j, i+x0+1, j);
                       j += 10;
                    }
                    
                    val = System.Convert.ToInt16(System.Convert.ToDouble(vals[i]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max))); //scalare
                    zona_des.DrawLine(pic, x0 + i+1, y0+1, x0 + i+1, y0 + h-2);
                    zona_des.DrawLine(creion_r, x0 + i, y0 + val_v, x0 + i+1, y0 + val);
                    val_v = val;
                 }
            }
            public void init_ins(int pozx, int pozy, int n_maxx, int n_maxy)
            {
                x0 = pozx;
                y0 = pozy;
                w = n_maxx;
                h = n_maxy;
                nr_max = n_maxx;
                val_max = n_maxy;   
            }
        }
    }
}

</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp87.gif"></center>
<a name="o_sin"></a>

<ul><li><b> Optimizarea clasei afisor_xt prin folosirea obiectului img </b></ul>

&nbsp;&nbsp;&nbsp;&nbsp;Pentru ptimizarea clasei afisor_xt, vom folosi obiectul imagine <b>img</b> in care vom crea imaginea graficului sub forma de puncte dupa care vom afisa imaginea img

<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_13
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public System.Drawing.Pen creion_rosu;
        public afisor_xt afisor_xt1;
        int pozx = 30, pozy = 10, n_maxx = 273, n_maxy = 205;
        double alfa = 0;
        double fi = 0;
        static int[] valori = new int[0];
        private void Form1_Load(object sender, EventArgs e)
        {
            Array.Resize(ref valori, n_maxx + 1);
            desen = this.CreateGraphics();
            creion_rosu = new System.Drawing.Pen(System.Drawing.Color.Red);
            afisor_xt1 = new afisor_xt();
            afisor_xt1.init_ins(pozx, pozy, n_maxx, n_maxy);
        }
        private void timer1_Tick(object sender, EventArgs e)
        {
            fi = fi + 0.3;
            alfa = fi;
            for (int i = 1; i <= n_maxx; i++)
            {
                alfa += 0.07;
                valori[i] = System.Convert.ToUInt16(n_maxy / 6 + ((n_maxy / 3) * (1 - Math.Sin(alfa))));
            }
            afisor_xt1.setval(desen,creion_rosu, valori, n_maxx);
        }
        public class afisor_xt
        {
            int x0;
            int y0;
            int w;
            int h;
            int val_max,val_v;
            int nr_max;
            System.Drawing.Bitmap img;
            public void setval(System.Drawing.Graphics zona_des,System.Drawing.Pen creion_r, int[] vals, int nrv)
            {
                int val, i, j;
                img = new Bitmap(w,h,zona_des);
                // sterg imaginea
                for (j = 0; j < h; j++)
                {
                    for (i = 0; i < w; i++)
                    {
                        img.SetPixel(i, j, System.Drawing.Color.WhiteSmoke);
                    }
                }
                // grid
                for (j = 0; j < h; j++)
                {
                    // grid orizontal
                    if (j % 10 == 0)
                    {
                        for (i = 0; i < w; i++)
                        {
                            if (j % 50 == 0)
                                img.SetPixel(i, j, System.Drawing.Color.Gray);
                            else
                                img.SetPixel(i, j, System.Drawing.Color.LightGray);
                        }
                    }
                    else{
                        // grid orizontal vertical
                        for (i = 0; i < w; i++)
                        {
                            if (i % 10 == 0)
                            {
                                if (i % 50 == 0)
                                    img.SetPixel(i, j, System.Drawing.Color.Gray);
                                else
                                    img.SetPixel(i, j, System.Drawing.Color.LightGray);
                            }
                        }
                    }
                }
                // afisare valoare sub forma de puncte
                /*
                for (i = 0; i < w; i++)
                {
                    val = System.Convert.ToInt16(System.Convert.ToDouble(vals[i]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max))); //scalare
                    img.SetPixel(i, val, System.Drawing.Color.Red);
                    if (val < h - 1) 
                        img.SetPixel(i, val + 1, System.Drawing.Color.Red);
                }
                 */
                //chenar
                for (i = 0; i < w; i++)
                {
                  img.SetPixel(i, 0, System.Drawing.Color.Blue);
                  img.SetPixel(i, h-1, System.Drawing.Color.Blue);
                }
                for (j = 0; j < h; j++)
                {
                    img.SetPixel(0,j, System.Drawing.Color.Blue);
                    img.SetPixel(w - 1,j, System.Drawing.Color.Blue);
                }
                zona_des.DrawImage(img, x0, y0);
                // afisare valoare sub forma de linii
                val_v = System.Convert.ToInt16(System.Convert.ToDouble(vals[1]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max)));
                for (i = 1; i < w-1; i++)
                {
                    val = System.Convert.ToInt16(System.Convert.ToDouble(vals[i]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max))); //scalare
                    zona_des.DrawLine(creion_r, x0 + i, y0 + val_v, x0 + i + 1, y0 + val);
                    val_v = val;
                }
            }
            public void init_ins(int pozx, int pozy, int n_maxx, int n_maxy)
            {
                x0 = pozx;
                y0 = pozy;
                w = n_maxx;
                h = n_maxy;
                nr_max = n_maxx;
                val_max = n_maxy;
            }
        }
    }
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp88.gif"></center>

<a name="ampl"></a>

<ul><li><b> Amplificarea si translatia </b></ul>

&nbsp;&nbsp;&nbsp;&nbsp;Vom utiliza in continuare clasa "afisor_xt" pentru afisare grafica in coordonate x-t, pentru afisarea functiei sin. 
Vom utiliza controale pentru modificarea amplitudinii, frecventei, deplasarii etc.

<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_14
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public System.Drawing.Pen creion_rosu;
        public afisor_xt instrum1;
        int pozx = 40, pozy = 80, n_maxx = 273, n_maxy = 205;
        double alfa = 0;
        double fi = 0;
        static int[] valori = new int[0];
        private void Form1_Load(object sender, EventArgs e)
        {
            Array.Resize(ref valori, n_maxx + 1);
            desen = this.CreateGraphics();
            creion_rosu = new System.Drawing.Pen(System.Drawing.Color.Red);
            instrum1 = new afisor_xt();
            instrum1.init_ins(pozx, pozy, n_maxx, n_maxy);
        }
       private void Form1_Paint(object sender, PaintEventArgs e)
        {
            this.trackBar1.Maximum = n_maxy/5;
            this.trackBar1.Minimum = -n_maxy/5;
            this.trackBar1.Value = 0;
            this.trackBar2.Maximum = n_maxy;
            this.trackBar2.Value = n_maxy / 3;
            this.trackBar3.Minimum = 1;
            this.trackBar3.Value = 14;
        }
        private void timer1_Tick(object sender, EventArgs e)
        {
            fi = fi + 0.3;
            alfa = fi;
            int transl =-this.trackBar1.Value;
            int amplif = this.trackBar2.Value;
            int zero = n_maxy / 2;
            for (int i = 1; i <= n_maxx; i++)
            {
                alfa += System.Convert.ToDouble( this.trackBar3.Value) / 100;
                int f = System.Convert.ToInt32(transl + zero-amplif * Math.Sin(alfa));
                if((f<n_maxy)&&(f>=0))
                    valori[i] = f;
                if (f > n_maxy)
                    valori[i] = n_maxy-1;
                if(f<0)
                    valori[i] = 0;
            }
            instrum1.setval(desen, creion_rosu, valori, n_maxx);
        }
    }

    // Clasa afisor_xt

    public class afisor_xt
    {
        int x0;
        int y0;
        int w;
        int h;
        int f, val_max, val_v;
        int nr_max;
        System.Drawing.Bitmap img;
        public void setval(System.Drawing.Graphics zona_des, System.Drawing.Pen creion_r, int[] vals, int nrv)
        {
            int val, i, j;
            img = new Bitmap(w, h, zona_des);
            // sterg imaginea
            for (j = 0; j < h; j++)
            {
                for (i = 0; i < w; i++)
                {
                    img.SetPixel(i, j, System.Drawing.Color.WhiteSmoke);
                }
            }
            // grid
            for (j = 0; j < h; j++)
            {
                // grid orizontal
                if (j % 10 == 0)
                {
                    for (i = 0; i < w; i++)
                    {
                        if (j % 50 == 0)
                            img.SetPixel(i, j, System.Drawing.Color.Gray);
                        else
                            img.SetPixel(i, j, System.Drawing.Color.LightGray);
                    }
                }
                else
                {
                    // grid orizontal vertical
                    for (i = 0; i < w; i++)
                    {
                        if (i % 10 == 0)
                        {
                            if (i % 50 == 0)
                                img.SetPixel(i, j, System.Drawing.Color.Gray);
                            else
                                img.SetPixel(i, j, System.Drawing.Color.LightGray);
                        }
                    }
                }
            }
            // afisare valoare sub forma de puncte
            /*
            for (i = 0; i < w; i++)
            {
                val = System.Convert.ToInt16(System.Convert.ToDouble(vals[i]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max))); //scalare
                img.SetPixel(i, val, System.Drawing.Color.Red);
                if (val < h - 1) 
                    img.SetPixel(i, val + 1, System.Drawing.Color.Red);
            }
             */
            //chenar
            for (i = 0; i < w; i++)
            {
                img.SetPixel(i, 0, System.Drawing.Color.Blue);
                img.SetPixel(i, h - 1, System.Drawing.Color.Blue);
            }
            for (j = 0; j < h; j++)
            {
                img.SetPixel(0, j, System.Drawing.Color.Blue);
                img.SetPixel(w - 1, j, System.Drawing.Color.Blue);
            }
            zona_des.DrawImage(img, x0, y0);
            // afisare valoare sub forma de linii
            val_v = System.Convert.ToInt16(System.Convert.ToDouble(vals[1]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max)));
            for (i = 1; i < w - 1; i++)
            {
                val = System.Convert.ToInt16(System.Convert.ToDouble(vals[i]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max))); //scalare
                zona_des.DrawLine(creion_r, x0 + i, y0 + val_v, x0 + i + 1, y0 + val);
                val_v = val;
            }
        }
        public void init_ins(int pozx, int pozy, int n_maxx, int n_maxy)
        {
            x0 = pozx;
            y0 = pozy;
            w = n_maxx;
            h = n_maxy;
            nr_max = n_maxx;
            val_max = n_maxy;
        }
    }
    // Gata clasa afisor_xt
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp90.gif"></center>
<a name="vit"></a>

<ul><li><b> Viteza de afisare  </b></ul>

&nbsp;&nbsp;&nbsp;&nbsp;Vom modifica in continuare obiectul "afisor_xt" pentru afisare grafica in coordonate x-t, pentru a obtine o viteza mai mare de afisare. 
Pentru aceasta vom crea o imagine de findal care contine grid-ul. Dupa fiecare afisare a imaginii, nu vom mai sterge imaginea si nu vom mai realiza 
din nou grid-ul. Vom incarca doar imaginea care e pregatita in prealabil, imagine care contine numai grid-ul.

<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_16
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public System.Drawing.Pen creion_rosu;
        public System.Drawing.Bitmap im;
        public afisor_xt instrum1;
        int pozx = 40, pozy = 80, n_maxx = 273, n_maxy = 205;
        double alfa = 0;
        double fi = 0;
        static int[] valori = new int[0];

        private void Form1_Load(object sender, EventArgs e)
        {
            Array.Resize(ref valori, n_maxx + 1);
            desen = this.CreateGraphics();
            creion_rosu = new System.Drawing.Pen(System.Drawing.Color.Red);
            instrum1 = new afisor_xt();
            instrum1.init_ins(pozx, pozy, n_maxx, n_maxy);

            //-------- creare imagine fundal ----------------

            int  i, j;
            im = new Bitmap(n_maxx, n_maxy, desen);
            // sterg imaginea
            for (j = 0; j < n_maxy; j++)
            {
                for (i = 0; i < n_maxx; i++)
                {
                    im.SetPixel(i, j, System.Drawing.Color.WhiteSmoke);
                }
            }
            // grid
            for (j = 0; j < n_maxy; j++)
            {
                // grid orizontal
                if (j % 10 == 0)
                {
                    for (i = 0; i < n_maxx; i++)
                    {
                        if (j % 50 == 0)
                            im.SetPixel(i, j, System.Drawing.Color.Gray);
                        else
                            im.SetPixel(i, j, System.Drawing.Color.LightGray);
                    }
                }
                else
                {
                    // grid orizontal vertical
                    for (i = 0; i < n_maxx; i++)
                    {
                        if (i % 10 == 0)
                        {
                            if (i % 50 == 0)
                                im.SetPixel(i, j, System.Drawing.Color.Gray);
                            else
                                im.SetPixel(i, j, System.Drawing.Color.LightGray);
                        }
                    }
                }
            }
            //chenar
            for (i = 0; i < n_maxx; i++)
            {
                im.SetPixel(i, 0, System.Drawing.Color.Blue);
                im.SetPixel(i, n_maxy - 1, System.Drawing.Color.Blue);
            }
            for (j = 0; j < n_maxy; j++)
            {
                im.SetPixel(0, j, System.Drawing.Color.Blue);
                im.SetPixel(n_maxx - 1, j, System.Drawing.Color.Blue);
            }

            // -------- gata imagine de fundal ----------
        }

        private void Form1_Paint(object sender, PaintEventArgs e)
        {
            this.trackBar1.Maximum = n_maxy / 5;
            this.trackBar1.Minimum = -n_maxy / 5;
            this.trackBar1.Value = 0;
            this.trackBar2.Maximum = n_maxy;
            this.trackBar2.Value = n_maxy / 3;
            this.trackBar3.Minimum = 1;
            this.trackBar3.Value = 14;
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            fi = fi + 0.3;
            alfa = fi;
            int transl = -this.trackBar1.Value;
            int amplif = this.trackBar2.Value;
            int zero = n_maxy / 2;
            for (int i = 1; i <= n_maxx; i++)
            {
                alfa += System.Convert.ToDouble(this.trackBar3.Value) / 100;
                int f = System.Convert.ToInt32(transl + zero - amplif * Math.Sin(alfa));
                if ((f < n_maxy) && (f >= 0))
                    valori[i] = f;
                if (f > n_maxy)
                    valori[i] = n_maxy - 1;
                if (f < 0)
                    valori[i] = 0;
            }
            desen.DrawImage(im, pozx,pozy);
            instrum1.setval(desen, creion_rosu, valori, n_maxx);
        }
    }
    public class afisor_xt
    {
        int x0;
        int y0;
        int w;
        int h;
        int val_max;
        int nr_max;
        System.Drawing.Bitmap img;
        public void setval(System.Drawing.Graphics zona_des, System.Drawing.Pen creion_r, int[] vals, int nrv)
        {
            int val, i, j;
            img = new Bitmap(w, h, zona_des);

            // afisare valoare sub forma de puncte
            for (i = 0; i < w; i++)
            {
                val = System.Convert.ToInt16(System.Convert.ToDouble(vals[i]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max))); //scalare
                img.SetPixel(i, val, System.Drawing.Color.Red);
                if (val < h - 1)
                    img.SetPixel(i, val + 1, System.Drawing.Color.Red);
            }
            zona_des.DrawImage(img, x0, y0);
            // afisare valoare sub forma de linii
            /*
            val_v = System.Convert.ToInt16(System.Convert.ToDouble(vals[1]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max)));
            for (i = 1; i < w - 1; i++)
            {
                val = System.Convert.ToInt16(System.Convert.ToDouble(vals[i]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max))); //scalare
                zona_des.DrawLine(creion_r, x0 + i, y0 + val_v, x0 + i + 1, y0 + val);
                val_v = val;
            }
            */

        }
        public void init_ins(int pozx, int pozy, int n_maxx, int n_maxy)
        {
            x0 = pozx;
            y0 = pozy;
            w = n_maxx;
            h = n_maxy;
            nr_max = n_maxx;
            val_max = n_maxy;
        }
    }
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp91.gif"></center>

<a name="osci"></a>

<ul><li><b> Clasa osciloscop </b></ul>
<br>&nbsp;&nbsp;&nbsp;&nbsp; Crearea imaginii de fundal ar trebui sa faca parte din clasa afisor_xt. Vom crea o noua clasa numita <b> osciloscop </b>
pe baza clasei afisor_xt la care adaugam crearea imaginii de fundal si afisarea valorilor numerice.
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_17
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public osciloscop osciloscop1;
        int pozx = 40, pozy = 80, n_maxx = 300, n_maxy = 200;
        double alfa = 0;
        double fi = 0;
        static int[] valori = new int[0];

        private void Form1_Load(object sender, EventArgs e)
        {
            Array.Resize(ref valori, n_maxx + 1);
            desen = this.CreateGraphics();
            osciloscop1 = new osciloscop(desen, pozx, pozy, n_maxx, n_maxy);

        }
        private void Form1_Paint(object sender, PaintEventArgs e)
        {
            this.trackBar1.Maximum = n_maxy / 5;
            this.trackBar1.Minimum = -n_maxy / 5;
            this.trackBar1.Value = 0;
            this.trackBar2.Maximum = n_maxy;
            this.trackBar2.Value = n_maxy / 3;
            this.trackBar3.Minimum = 1;
            this.trackBar3.Value = 14;
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            fi = fi + 0.3;
            alfa = fi;
            int transl = -this.trackBar1.Value;
            int amplif = this.trackBar2.Value;
            int fr = this.trackBar3.Value;
            int zero = n_maxy / 2;
            for (int i = 1; i <= n_maxx; i++)
            {
                alfa += System.Convert.ToDouble(fr) / 100;
                int f = System.Convert.ToInt32(transl + zero - amplif * Math.Sin(alfa));
                if ((f < n_maxy) && (f >= 0))
                    valori[i] = f;
                if (f > n_maxy)
                    valori[i] = n_maxy - 1;
                if (f < 0)
                    valori[i] = 0;
            }

            osciloscop1.setval(valori, n_maxx, amplif, fr);
        }
    }

    // --- Clasa osciloscop --------

    public class osciloscop
    {
        int x0;
        int y0;
        int w;
        int h;
        int val_max;
        int nr_max;
        System.Drawing.Graphics zona_des;
        System.Drawing.Pen creion_r = new System.Drawing.Pen(System.Drawing.Color.Red);
        System.Drawing.Font font_ni = new System.Drawing.Font("Nina", 8);
        System.Drawing.SolidBrush pens_blu = new System.Drawing.SolidBrush(System.Drawing.Color.Blue);
        System.Drawing.SolidBrush radiera = new System.Drawing.SolidBrush(System.Drawing.Color.White);

        System.Drawing.Bitmap img;
        System.Drawing.Bitmap ims;

        public void setval(int[] vals, int nrv, int ampl, int fr)
        {
            img = new Bitmap(ims);
            int val, i;

            // afisare grafic sub forma de puncte

            for (i = 0; i < w; i++)
            {
                val = System.Convert.ToInt16(System.Convert.ToDouble(vals[i]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max))); //scalare
                img.SetPixel(i, val, System.Drawing.Color.Red);
                if (val < h - 1)
                    img.SetPixel(i, val + 1, System.Drawing.Color.Red);
            }
            zona_des.DrawImage(img, x0, y0);
            zona_des.FillRectangle(radiera, x0, y0 + h, w + 20, 20);

            // Afisare valoi axa x

            for (i = 0; i <= w; i += 50)
            {
                val = System.Convert.ToInt16(System.Convert.ToDouble(i * fr / 30) * (System.Convert.ToDouble(nr_max) / System.Convert.ToDouble(w))); //scalare
                zona_des.DrawString(val.ToString(), font_ni, pens_blu, x0 + i, y0 + h);
            }

            // Afisare valoi axa y

            zona_des.FillRectangle(radiera, x0 - 20, y0 - 10, 20, h + 20);
            for (i = 0; i <= h; i += 50)
            {
                val = System.Convert.ToInt16(System.Convert.ToDouble(i * ampl / 100) * (System.Convert.ToDouble(val_max) / System.Convert.ToDouble(h))); //scalare
                zona_des.DrawString(val.ToString(), font_ni, pens_blu, x0 - 20, y0 + h - i - 10);
            }
        }

        // Clasa osciloscop

        public osciloscop(System.Drawing.Graphics desen, int pozx, int pozy, int n_maxx, int n_maxy)
        {
            x0 = pozx;
            y0 = pozy;
            w = n_maxx;
            h = n_maxy;
            nr_max = n_maxx;
            val_max = n_maxy;
            zona_des = desen;
            int i, j;
            ims = new Bitmap(nr_max, n_maxy, zona_des);
  
            // sterg imaginea

            for (j = 0; j < val_max; j++)
            {
                for (i = 0; i < nr_max; i++)
                {
                    ims.SetPixel(i, j, System.Drawing.Color.WhiteSmoke);
                }
            }
            // grid
            for (j = 0; j < val_max; j++)
            {

                // grid orizontal


                if (j % 10 == 0)
                {
                    for (i = 0; i < nr_max; i++)
                    {
                        if (j % 50 == 0)
                            ims.SetPixel(i, j, System.Drawing.Color.Gray);
                        else
                            ims.SetPixel(i, j, System.Drawing.Color.LightGray);
                    }
                }
                else
                {

                    // grid orizontal vertical

                    for (i = 0; i < nr_max; i++)
                    {
                        if (i % 10 == 0)
                        {
                            if (i % 50 == 0)
                                ims.SetPixel(i, j, System.Drawing.Color.Gray);
                            else
                                ims.SetPixel(i, j, System.Drawing.Color.LightGray);
                        }
                    }
                }
            }

            //chenar

            for (i = 0; i < n_maxx; i++)
            {
                ims.SetPixel(i, 0, System.Drawing.Color.Blue);
                ims.SetPixel(i, val_max - 1, System.Drawing.Color.Blue);
            }
            for (j = 0; j < val_max; j++)
            {
                ims.SetPixel(0, j, System.Drawing.Color.Blue);
                ims.SetPixel(nr_max - 1, j, System.Drawing.Color.Blue);
            }
        } 
    }
    // --------- Gata clasa osciloscop ----------
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br>&nbsp;&nbsp;&nbsp;&nbsp; Din cauza afisarii sub forma de puncte calitatea imaginii scade dar viteza este mult mai mare. 
<br><br><center><img src="im_cpp129.jpg"></center><br>

<a name="opti_o"></a>

<ul><li><b> Optimizare clasa osciloscop </b></ul>
&nbsp;&nbsp;&nbsp;&nbsp;Modificam clasa osciloscop astfel incat sa pastram afisarea sub forma de puncte dar adaugam puncte 
suplimentare astfel incat graficul sa para continuu. De asemenea, din cauza faprului ca se afiseaza coordonate dinamice, trebuie 
stearsa zona in care se afiseaza coordonatele dupa care se afisez din nou. Daca nu se sterge zona, coordonatele se suprascriu, 
si devin neinteligibile. Din cauza acestei operatii coordonatele "clipesc" cand se afiseaza din cauza stergerii anterioare. Vom 
incerca sa le scriem direct pe imaginea cu graficul, evitand astfel fenomenul de clipire.

<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_18
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public osciloscop osciloscop1;
        int pozx = 40, pozy = 80, n_maxx = 300, n_maxy = 200;
        double alfa = 0;
        double fi = 0;
        static int[] valori = new int[0];

        private void Form1_Load(object sender, EventArgs e)
        {
            Array.Resize(ref valori, n_maxx + 1);
            desen = this.CreateGraphics();
            osciloscop1 = new osciloscop(desen, pozx, pozy, n_maxx, n_maxy);
        }

        private void Form1_Paint(object sender, PaintEventArgs e)
        {
            this.trackBar1.Maximum = n_maxy / 5;
            this.trackBar1.Minimum = -n_maxy / 5;
            this.trackBar1.Value = 0;
            this.trackBar2.Maximum = n_maxy;
            this.trackBar2.Value = n_maxy / 3;
            this.trackBar3.Minimum = 1;
            this.trackBar3.Value = 14;
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            fi = fi + 0.3;
            alfa = fi;
            alfa = 0;
            int transl = -this.trackBar1.Value;
            int amplif = this.trackBar2.Value;
            int fr = this.trackBar3.Value;
            int zero = n_maxy / 2;
            for (int i = 1; i <= n_maxx; i++)
            {
                alfa += System.Convert.ToDouble(fr) / 100;
                int f = System.Convert.ToInt32(transl + zero - amplif * Math.Sin(alfa));
                if ((f < n_maxy) && (f >= 0))
                    valori[i] = f;
                if (f > n_maxy)
                    valori[i] = n_maxy - 1;
                if (f < 0)
                    valori[i] = 0;
            }

            osciloscop1.setval(valori, n_maxx, amplif, fr);

        }
    }

    // --------------Clasa osciloscop ------------------
 
    public class osciloscop
    {
        int x0;
        int y0;
        int w;
        int h;
        int val_max;
        int nr_max;
        System.Drawing.Graphics zona_des;
        System.Drawing.Pen creion_r = new System.Drawing.Pen(System.Drawing.Color.Red);
        System.Drawing.Font font_ni = new System.Drawing.Font("Nina", 8);
        System.Drawing.SolidBrush pens_blu = new System.Drawing.SolidBrush(System.Drawing.Color.Blue);
        System.Drawing.SolidBrush radiera = new System.Drawing.SolidBrush(System.Drawing.Color.White);

        System.Drawing.Bitmap img;
        System.Drawing.Bitmap ims;

        public void setval(int[] vals, int nrv, int ampl, int fr)
        {
            img = new Bitmap(ims);
            int val,val_v, i, j;
            val_v = System.Convert.ToInt16(System.Convert.ToDouble(vals[0]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max)));

            // afisare grafic sub forma de puncte unite cu linii

            for (i = 0; i < w; i++)
            {
                val = System.Convert.ToInt16(System.Convert.ToDouble(vals[i]) * (System.Convert.ToDouble(h) / System.Convert.ToDouble(val_max))); //scalare
                if (val_v < val)
                {
                    // unesc doua puncte cu o linie crescatoare
                    for (j = val_v; j <= val; j++)
                        img.SetPixel(i, j, System.Drawing.Color.Red);
                }
                else
                {
                    // unesc doua puncte cu o linie descrescatoare
                    for (j = val; j <= val_v; j++)
                        img.SetPixel(i, j, System.Drawing.Color.Red);

                }
                val_v = val;
            }

            // gata afisare grafic sub forma de puncte

            // Afisare valori axa x

            Graphics g = Graphics.FromImage(img);
            
            for (i = 0; i <= w; i += 50)
            {
                val = System.Convert.ToInt16(System.Convert.ToDouble(i * fr / 30) * (System.Convert.ToDouble(nr_max) / System.Convert.ToDouble(w))); //scalare
                g.DrawString(val.ToString(), font_ni, pens_blu, i, h-15);
            }

            // Afisare valori axa y

           
            for (i = 1; i <= h; i += 50)
            {
                val = System.Convert.ToInt16(System.Convert.ToDouble(i * ampl / 100) * (System.Convert.ToDouble(val_max) / System.Convert.ToDouble(h))); //scalare
                g.DrawString(val.ToString(), font_ni, pens_blu, 2, h - i - 10);
            }
            zona_des.DrawImage(img, x0, y0);
        }
        public osciloscop(System.Drawing.Graphics desen, int pozx, int pozy, int n_maxx, int n_maxy)
        {
            x0 = pozx;
            y0 = pozy;
            w = n_maxx;
            h = n_maxy;
            nr_max = n_maxx;
            val_max = n_maxy;
            zona_des = desen;
            int i, j;
            ims = new Bitmap(nr_max, n_maxy, zona_des);

            // sterg imaginea

            for (j = 0; j < val_max; j++)
            {
                for (i = 0; i < nr_max; i++)
                {
                    ims.SetPixel(i, j, System.Drawing.Color.WhiteSmoke);
                }
            }

            // grid

            for (j = 0; j < val_max; j++)
            {

                // grid orizontal


                if (j % 10 == 0)
                {
                    for (i = 0; i < nr_max; i++)
                    {
                        if (j % 50 == 0)
                            ims.SetPixel(i, j, System.Drawing.Color.Gray);
                        else
                            ims.SetPixel(i, j, System.Drawing.Color.LightGray);
                    }
                }
                else
                {

                    // grid orizontal vertical

                    for (i = 0; i < nr_max; i++)
                    {
                        if (i % 10 == 0)
                        {
                            if (i % 50 == 0)
                                ims.SetPixel(i, j, System.Drawing.Color.Gray);
                            else
                                ims.SetPixel(i, j, System.Drawing.Color.LightGray);
                        }
                    }
                }
            }

            //chenar

            for (i = 0; i < n_maxx; i++)
            {
                ims.SetPixel(i, 0, System.Drawing.Color.Blue);
                ims.SetPixel(i, val_max - 1, System.Drawing.Color.Blue);
            }
            for (j = 0; j < val_max; j++)
            {
                ims.SetPixel(0, j, System.Drawing.Color.Blue);
                ims.SetPixel(nr_max - 1, j, System.Drawing.Color.Blue);
            }
        }
    }
    // --------------Sfarsit clasa osciloscop ------------------ 
}

</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp128.jpg"></center><br>
<br>&nbsp;&nbsp;&nbsp;&nbsp;Pe baza experientei acumulate in perfectionarea clasei <b>osciloscop</b> sa incercam sa definitivam aceasta clasa 
astfel incat ea sa poata fi folosita in general pentru afisarea unei functii f(x) oarecare.
<br>&nbsp;&nbsp;&nbsp;&nbsp;Se vor elimina parametrii <b> fr</b> si <b> amplif</b> acestia fiind un caz particular pentru afisarea unui sinus 
de amplitudine si frecventa variabila.
<br>&nbsp;&nbsp;&nbsp;&nbsp;Pentru utilizarea mai simpla a acestei clase, se va modifica sensul axei y astfel ca atunci cand se va afisa o functie, 
nu mai trebuie afisata -functia, inversiunea sensului axei facandu-se in cadrul clasei. Pentru scalare, se vor aduga param <b> val_max</b> si 
<b> val_min</b>. Pe baza acestor valori se va calcula <b> amplif</b> si <b> transl</b>. 
<br>&nbsp;&nbsp;&nbsp;&nbsp;In concluzie, pentru utilizarea clasei, utilizatorul trebuie doar sa inscrie valorile penru afisat intr-un vector si sa 
precizeze valoarea maxima si minima de afisat. V-a trebi sa definim vectorul de tip double avand in vedere ca vectorul nu mai contine coordonata y a 
punctelor ce urmeaza a fi afisate, acesta continand efectiv valori ale finctiei ce urmeaza a fi reprezentata.
<br>&nbsp;&nbsp;&nbsp;&nbsp;Vom relua deci afisarea functiei sinus dar fara butoanele pentru translatie, amplificare etc.

<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_19
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public osciloscop oscil;
        int pozx = 40, pozy = 10, n_maxx = 300, n_maxy = 200;
        double val_max = 1.5, val_min=-1.5;
        static double[] valori = new double[0];
        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            Array.Resize(ref valori, n_maxx + 1);
            oscil = new osciloscop(desen, pozx, pozy, n_maxx, n_maxy, val_max, val_min);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            double fi = this.trackBar1.Value / 100.0;
            double alfa = 0;
            for (int i = 1; i <= n_maxx; i++)
            {
                alfa += 0.05;
                valori[i] = Math.Sin(alfa - fi);
            }
            oscil.setval(valori, n_maxx, Color.Red);
        }
    }

    // --------------Clasa osciloscop ------------------

    public class osciloscop
    {
        int x0, y0, w, h, val, val_v;
        double v_max, v_min;
        System.Drawing.Graphics zona_des;
        System.Drawing.Pen creion_r = new System.Drawing.Pen(System.Drawing.Color.Red);
        System.Drawing.Font font_ni = new System.Drawing.Font("Nina", 8);
        System.Drawing.SolidBrush pens_blu = new System.Drawing.SolidBrush(System.Drawing.Color.Blue);
        System.Drawing.SolidBrush radiera = new System.Drawing.SolidBrush(System.Drawing.Color.White);

        System.Drawing.Bitmap img;
        System.Drawing.Bitmap ims;

        public void setval(double[] vals, int nrv, System.Drawing.Color cul)
        {
            int i, j;
            img = new Bitmap(ims);

            // afisare grafic sub forma de puncte
            double amplif=(System.Convert.ToDouble(h) / System.Convert.ToDouble(v_max-v_min));
            double transl = v_min * amplif;
            val_v = System.Convert.ToInt16(h + transl- amplif* System.Convert.ToDouble(vals[0])) ; //scalare
            if (val_v >= h)
                val_v = h - 1;
            if (val_v <= 0)
                val_v = 1;
            for (i = 0; i < w; i++)
            {
                val = System.Convert.ToInt16(h + transl - amplif * System.Convert.ToDouble(vals[i]));  //scalare
                if (val >= h)
                    val = h - 1;
                if (val <= 0)
                    val = 1;
                if (val_v < val)
                {
                    // unesc doua puncte cu o linie crescatoare
                    for (j = val_v; j <= val; j++)
                    {
                        img.SetPixel(i, j, cul);

                    }
                }
                else
                {
                    // unesc doua puncte cu o linie descrescatoare
                    for (j = val; j <= val_v; j++)
                    {
                        img.SetPixel(i, j, cul);
                    }
                }
                val_v = val;
            }
            Graphics g = Graphics.FromImage(img);

            //valori axa x

            for (i = 50; i <= w; i += 50)
            {
                val = System.Convert.ToInt16(System.Convert.ToDouble(i) * (System.Convert.ToDouble(w) / System.Convert.ToDouble(w))); //scalare
                g.DrawString(val.ToString(), font_ni, pens_blu, i, h - 15);
            }

            //valori axa y

            double vg = v_min;
            double pas = System.Convert.ToDouble(v_max-v_min) / System.Convert.ToDouble(h) * 50;

            for (i = 50; i < h; i += 50)
            {
                vg = vg + pas;
                val = System.Convert.ToInt16(System.Convert.ToDouble(i) * (System.Convert.ToDouble(v_max-v_min) / System.Convert.ToDouble(h))); //scalare
                g.DrawString(Math.Round(vg, 2).ToString(), font_ni, pens_blu, 2, h - i - 10);              
            }
            zona_des.DrawImage(img, x0, y0);
        }
        public osciloscop(System.Drawing.Graphics desen, int pozx, int pozy, int n_maxx, int n_maxy, double val_max, double val_min)
        {
            x0 = pozx;
            y0 = pozy;
            w = n_maxx;
            h = n_maxy;
            v_max = val_max;
            v_min = val_min;
            zona_des = desen;
            img = new Bitmap(w, h, zona_des);
            ims = new Bitmap(w, h, zona_des);
            int i, j;
      
            // sterg imaginea

            for (j = 0; j < h; j++)
            {
                for (i = 0; i < w; i++)
                {
                    ims.SetPixel(i, j, System.Drawing.Color.WhiteSmoke);
                }
            }
            // grid
            for (j = 0; j < h; j++)
            {
                // grid orizontal

                if (j % 10 == 0)
                {
                    for (i = 0; i < w; i++)
                    {
                        if (j % 50 == 0)
                            ims.SetPixel(i, j, System.Drawing.Color.Gray);
                        else
                            ims.SetPixel(i, j, System.Drawing.Color.LightGray);
                    }
                }
                else
                {

                    // grid orizontal vertical

                    for (i = 0; i < w; i++)
                    {
                        if (i % 10 == 0)
                        {
                            if (i % 50 == 0)
                                ims.SetPixel(i, j, System.Drawing.Color.Gray);
                            else
                                ims.SetPixel(i, j, System.Drawing.Color.LightGray);
                        }
                    }
                }
            }

            //chenar

            for (i = 0; i < w; i++)
            {
                ims.SetPixel(i, 0, System.Drawing.Color.Blue);
                ims.SetPixel(i, h - 1, System.Drawing.Color.Blue);
            }
            for (j = 0; j < h; j++)
            {
                ims.SetPixel(0, j, System.Drawing.Color.Blue);
                ims.SetPixel(w - 1, j, System.Drawing.Color.Blue);
            }
        }
    }
    // --------------Sfarsit clasa osciloscop ------------------
    }
</pre> </font>
</td></tr></table>
<br>&nbsp;&nbsp;&nbsp;&nbsp;Dupa cum se observa utilizatorul nu trebuie decat sa creeze obiectul <b> oscil </b>
<br><center> <b>oscil = new osciloscop(desen, pozx, pozy, n_maxx, n_maxy, val_max, val_min);</b></center>
dupa care inscrie in vectorul valori[] valorile ce urmeaza a fi afisate si sa invoce metoda <b> setval </b>. 
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
        private void timer1_Tick(object sender, EventArgs e)
        {
            double fi = this.trackBar1.Value / 100.0;
            double alfa = 0;
            for (int i = 1; i <= n_maxx; i++)
            {
                alfa += 0.05;
                valori[i] = Math.Sin(alfa - fi);
            }
            oscil.setval(valori, n_maxx, Color.Red);
        }
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->

<a name="autos"></a>

<ul><li><b> Autoscalare</b></ul>
&nbsp;&nbsp;&nbsp;&nbsp;In exemplul anterior, utilizatorul trebuia sa precizeze  <b> val_max</b> 
si <b> val_min</b>. Avand valorile pentru afisat inscrise in vector, teoretic clasa nu ar mai avea nevoie de <b> val_max</b> 
si <b> val_min</b>, acestea putand fi calculate, insa daca dorim sa perfectionam in continuare clasa si sa afisam mai multe canale, utilizatorul trebuie
sa decida cm vrea sa arate imaginea de ansamblu si deci stabileste <b> val_max</b> si <b> val_min</b>. Pentru a intruni aeste cerinte vom adauga o 
metoda pentru autoscalare, care va putea fi apelata numai daca utilizatorul doreste acest lucru.
<br>&nbsp;&nbsp;&nbsp;&nbsp;In exemplul anterior pe coordonata x nu se afiseaza valoarea lui x, se afiseaza numarul curent al pozitiei pixelului. Pentru 
afisarea efectiva a valorii lui x va trebui sa mai introducem o metoda, astfel putem afisa numarul de ordine sau x.
<br>&nbsp;&nbsp;&nbsp;&nbsp;In aplicatia urmatoare vom afisa un sinus de amplitudine si frecventa variabila si vom introduce metodele amintite.
<br><br><center><img src="im_cpp137.jpg"></center><br>
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_19_fr
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public osciloscop oscil;
        int pozx = 70, pozy = 10, n_maxx = 400, n_maxy = 200;
        double val_max = 1.5, val_min = -1.5;
        static double[] valori = new double[0];
        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            Array.Resize(ref valori, n_maxx + 1);
            oscil = new osciloscop(desen, pozx, pozy, n_maxx, n_maxy, val_max, val_min);

        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            double a = this.trackBar2.Value / 100.0;
            double f = this.trackBar1.Value / 100.0;
            double alfa = 0, min, max;
            double pas=0.03;
            for (int i = 1; i <= n_maxx; i++)
            {
                alfa += pas;
                valori[i] = a*Math.Sin(f*alfa);

            }
            min = valori[0];
            max = valori[0];
            for (int i = 1; i <= n_maxx; i++)
            {
               if(valori[i] > max)
                   max = valori[i];
               if (valori[i] < min)
                   min = valori[i];
            }
            if(this.checkBox1.Checked)
                oscil.auto_sy( max,min);
            else
                oscil.auto_sy(val_max, val_min);
            if (this.checkBox2.Checked)
                oscil.auto_sx(f*pas*n_maxx, 0);
            else
                oscil.auto_sx(n_maxx, 0);
            oscil.setval(valori, n_maxx, Color.Red);
        }
    }
    // --------------Clasa osciloscop ------------------

    public class osciloscop
    {
        int x0, y0, w, h, val, val_v;
        double v_max, v_min, x_max, x_min;
        System.Drawing.Graphics zona_des;
        System.Drawing.Pen creion_r = new System.Drawing.Pen(System.Drawing.Color.Red);
        System.Drawing.Font font_ni = new System.Drawing.Font("Nina", 8);
        System.Drawing.SolidBrush pens_blu = new System.Drawing.SolidBrush(System.Drawing.Color.Blue);
        System.Drawing.SolidBrush radiera = new System.Drawing.SolidBrush(System.Drawing.Color.White);

        System.Drawing.Bitmap img;
        System.Drawing.Bitmap ims;

        public void auto_sy(double val_max, double val_min)
        {
            if (val_max - val_min != 0)
            {
                v_max = val_max;
                v_min = val_min;
            }
        }
        public void auto_sx(double x_maxim, double x_minim)
        {
            if (x_max - x_min != 0)
            {
                x_max = x_maxim;
                x_min = x_minim;
            }
            else
            {
                x_max = w;
                x_min = 0;
            }
        }
        public void setval(double[] vals, int nrv, System.Drawing.Color cul)
        {
            int i, j;
            if (w > 0 && h > 0)
            {
                img = new Bitmap(ims);

                // afisare grafic sub forma de puncte
                double amplif;
                if ((v_max - v_min) != 0)
                    amplif = (System.Convert.ToDouble(h) / System.Convert.ToDouble(v_max - v_min));
                else
                    amplif = 1;
                double transl = v_min * amplif;
                val_v = System.Convert.ToInt16(h + transl - amplif * System.Convert.ToDouble(vals[0])); //scalare
                if (val_v >= h)
                    val_v = h - 1;
                if (val_v <= 0)
                    val_v = 1;
                for (i = 0; i < w; i++)
                {
                    val = System.Convert.ToInt16(h + transl - amplif * System.Convert.ToDouble(vals[i]));  //scalare
                    if (val >= h)
                        val = h - 1;
                    if (val <= 0)
                        val = 1;
                    if (val_v < val)
                    {
                        // unesc doua puncte cu o linie crescatoare
                        for (j = val_v; j <= val; j++)
                        {
                            img.SetPixel(i, j, cul);

                        }
                    }
                    else
                    {
                        // unesc doua puncte cu o linie descrescatoare
                        for (j = val; j <= val_v; j++)
                        {
                            img.SetPixel(i, j, cul);
                        }
                    }
                    val_v = val;
                }
                Graphics g = Graphics.FromImage(img);

                //valori axa x

                double vx = x_min;
                double pasx = System.Convert.ToDouble(x_max - x_min) / System.Convert.ToDouble(w) * 50;
                for (i = 50; i < w; i += 50)
                {
                    vx = vx + pasx;
                    g.DrawString(Math.Round(vx, 2).ToString(), font_ni, pens_blu, i, h - 15);

                }

                //valori axa y

                double vy = v_min;
                double pasy = System.Convert.ToDouble(v_max - v_min) / System.Convert.ToDouble(h) * 50;
                for (i = 50; i < h; i += 50)
                {
                    vy = vy + pasy;
                    g.DrawString(Math.Round(vy, 2).ToString(), font_ni, pens_blu, 2, h - i - 10);
                }
                zona_des.DrawImage(img, x0, y0);
            }
        }
        public osciloscop(System.Drawing.Graphics desen, int pozx, int pozy, int n_maxx, int n_maxy, double val_max, double val_min)
        {
            x0 = pozx;
            y0 = pozy;
            w = n_maxx;
            h = n_maxy;
            v_max = val_max;
            v_min = val_min;
            x_max = n_maxx;
            x_min = 0;
            zona_des = desen;
            if (w > 0 && h > 0)
            {
                img = new Bitmap(w, h, zona_des);
                ims = new Bitmap(w, h, zona_des);
                int i, j;

                // sterg imaginea

                for (j = 0; j < h; j++)
                {
                    for (i = 0; i < w; i++)
                    {
                        ims.SetPixel(i, j, System.Drawing.Color.WhiteSmoke);
                    }
                }
                // grid
                for (j = 0; j < h; j++)
                {
                    // grid orizontal

                    if (j % 10 == 0)
                    {
                        for (i = 0; i < w; i++)
                        {
                            if (j % 50 == 0)
                                ims.SetPixel(i, j, System.Drawing.Color.Gray);
                            else
                                ims.SetPixel(i, j, System.Drawing.Color.LightGray);
                        }
                    }
                    else
                    {

                        // grid orizontal vertical

                        for (i = 0; i < w; i++)
                        {
                            if (i % 10 == 0)
                            {
                                if (i % 50 == 0)
                                    ims.SetPixel(i, j, System.Drawing.Color.Gray);
                                else
                                    ims.SetPixel(i, j, System.Drawing.Color.LightGray);
                            }
                        }
                    }
                }

                //chenar

                for (i = 0; i < w; i++)
                {
                    ims.SetPixel(i, 0, System.Drawing.Color.Blue);
                    ims.SetPixel(i, h - 1, System.Drawing.Color.Blue);
                }
                for (j = 0; j < h; j++)
                {
                    ims.SetPixel(0, j, System.Drawing.Color.Blue);
                    ims.SetPixel(w - 1, j, System.Drawing.Color.Blue);
                }
            }
        }
    }
    // --------------Sfarsit clasa osciloscop ------------------
}

</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br>&nbsp;&nbsp;&nbsp;&nbsp;S-au adaugat deci cele doua metode:
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
        public void auto_sy(double val_max, double val_min)
        {
            if (val_max - val_min != 0)
            {
                v_max = val_max;
                v_min = val_min;
            }
        }
        public void auto_sx(double x_maxim, double x_minim)
        {
            if (x_max - x_min != 0)
            {
                x_max = x_maxim;
                x_min = x_minim;
            }
            else
            {
                x_max = w;
                x_min = 0;
            }
        }
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->

<br>&nbsp;&nbsp;&nbsp;&nbsp;In cazul in care nu se doreste autoscalare si afisare x, se obtine:
<br><br><center><img src="im_cpp138.jpg"></center><br>

<a name="multi"></a>

<ul><li><b> Afisare in coordonate x-t pe mai multe canale</b></ul>

&nbsp;&nbsp;&nbsp;&nbsp;In principiu putem folosi clasa osciloscop cu mici modificari. Dupa ce am trasat graficul unei functii, 
prin metoda <b> set_val </b> se face implicit stergere continut, creare imagine grafic, si afisare grafic. Pentru a putea afisa mai multe canale, 
trebuie sa despartim metoda <b> set_val </b> in metodele: <b> sterg() </b> , <b> set_val </b> , <b> display() </b>. Astfel vom apela metoda 
<b> sterg() </b>, dupa care metoda  <b> set_val </b> pentru fiecare canal in parte si la sfarsit metoda <b> display()</b> care afiseaza toate 
canalele simultan.
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_50
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public osciloscop oscil_m;
        int pozx = 40, pozy = 10, n_maxx = 500, n_maxy = 200;
        double val_max = 2, val_min=-2;
        static double[] valori1 = new double[0];
        static double[] valori2 = new double[0];
    
        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            Array.Resize(ref valori1, n_maxx + 1);
            Array.Resize(ref valori2, n_maxx + 1);
            oscil_m = new osciloscop(desen, pozx, pozy, n_maxx, n_maxy, val_max, val_min);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            double a = this.trackBar1.Value / 100.0;
            double k = this.trackBar2.Value/100.0;
            double alfa = 0;
            double pas = 0.05;
            for (int i = 1; i <= n_maxx; i++)
            {
                alfa += pas;
                valori1[i] = a*Math.Sin(alfa);
                valori2[i] = Math.Sin(k*alfa);
            }
            oscil_m.sterg();
            if (this.checkBox1.Checked)
                oscil_m.auto_sx(pas*k*n_maxx, 0);
            else
                oscil_m.auto_sx(n_maxx, 0);
            oscil_m.setval(valori1, n_maxx, Color.Red);
            oscil_m.setval(valori2, n_maxx, Color.Green);
            oscil_m.display();
        }
    }
    // --------------Clasa osciloscop ------------------

    public class osciloscop
    {
        int x0, y0, w, h, val, val_v;
        double v_max, v_min, x_max, x_min;
        System.Drawing.Graphics zona_des;
        System.Drawing.Pen creion_r = new System.Drawing.Pen(System.Drawing.Color.Red);
        System.Drawing.Font font_ni = new System.Drawing.Font("Nina", 8);
        System.Drawing.SolidBrush pens_blu = new System.Drawing.SolidBrush(System.Drawing.Color.Blue);
        System.Drawing.SolidBrush radiera = new System.Drawing.SolidBrush(System.Drawing.Color.White);

        System.Drawing.Bitmap img;
        System.Drawing.Bitmap ims;
        public void sterg()
        {
            img = new Bitmap(ims);
        }
        public void display()
        {
            zona_des.DrawImage(img, x0, y0);
        }
        public void auto_sy(double val_max, double val_min)
        {
            if (val_max - val_min != 0)
            {
                v_max = val_max;
                v_min = val_min;
            }
        }
        public void auto_sx(double x_maxim, double x_minim)
        {
            if (x_max - x_min != 0)
            {
                x_max = x_maxim;
                x_min = x_minim;
            }
            else
            {
                x_max = w;
                x_min = 0;
            }
        }
        public void setval(double[] vals, int nrv, System.Drawing.Color cul)
        {
            int i, j;
            if (w > 0 && h > 0)
            {
                // afisare grafic sub forma de puncte
                double amplif;
                if ((v_max - v_min) != 0)
                    amplif = (System.Convert.ToDouble(h) / System.Convert.ToDouble(v_max - v_min));
                else
                    amplif = 1;
                double transl = v_min * amplif;
                val_v = System.Convert.ToInt16(h + transl - amplif * System.Convert.ToDouble(vals[0])); //scalare
                if (val_v >= h)
                    val_v = h - 1;
                if (val_v <= 0)
                    val_v = 1;
                for (i = 0; i < w; i++)
                {
                    val = System.Convert.ToInt16(h + transl - amplif * System.Convert.ToDouble(vals[i]));  //scalare
                    if (val >= h)
                        val = h - 1;
                    if (val <= 0)
                        val = 1;
                    if (val_v < val)
                    {
                        // unesc doua puncte cu o linie crescatoare
                        for (j = val_v; j <= val; j++)
                        {
                            img.SetPixel(i, j, cul);

                        }
                    }
                    else
                    {
                        // unesc doua puncte cu o linie descrescatoare
                        for (j = val; j <= val_v; j++)
                        {
                            img.SetPixel(i, j, cul);
                        }
                    }
                    val_v = val;
                }
                Graphics g = Graphics.FromImage(img);

                //valori axa x

                double vx = x_min;
                double pasx = System.Convert.ToDouble(x_max - x_min) / System.Convert.ToDouble(w) * 50;
                for (i = 50; i < w; i += 50)
                {
                    vx = vx + pasx;
                    g.DrawString(Math.Round(vx, 2).ToString(), font_ni, pens_blu, i, h - 15);

                }

                //valori axa y

                double vy = v_min;
                double pasy = System.Convert.ToDouble(v_max - v_min) / System.Convert.ToDouble(h) * 50;
                for (i = 50; i < h; i += 50)
                {
                    vy = vy + pasy;
                    g.DrawString(Math.Round(vy, 2).ToString(), font_ni, pens_blu, 2, h - i - 10);
                }
            }
        }
        public osciloscop(System.Drawing.Graphics desen, int pozx, int pozy, int n_maxx, int n_maxy, double val_max, double val_min)
        {
            x0 = pozx;
            y0 = pozy;
            w = n_maxx;
            h = n_maxy;
            v_max = val_max;
            v_min = val_min;
            x_max = n_maxx;
            x_min = 0;
            zona_des = desen;
            if (w > 0 && h > 0)
            {
                img = new Bitmap(w, h, zona_des);
                ims = new Bitmap(w, h, zona_des);
                int i, j;

                // sterg imaginea

                for (j = 0; j < h; j++)
                {
                    for (i = 0; i < w; i++)
                    {
                        ims.SetPixel(i, j, System.Drawing.Color.WhiteSmoke);
                    }
                }
                // grid
                for (j = 0; j < h; j++)
                {
                    // grid orizontal

                    if (j % 10 == 0)
                    {
                        for (i = 0; i < w; i++)
                        {
                            if (j % 50 == 0)
                                ims.SetPixel(i, j, System.Drawing.Color.Gray);
                            else
                                ims.SetPixel(i, j, System.Drawing.Color.LightGray);
                        }
                    }
                    else
                    {

                        // grid orizontal vertical

                        for (i = 0; i < w; i++)
                        {
                            if (i % 10 == 0)
                            {
                                if (i % 50 == 0)
                                    ims.SetPixel(i, j, System.Drawing.Color.Gray);
                                else
                                    ims.SetPixel(i, j, System.Drawing.Color.LightGray);
                            }
                        }
                    }
                }

                //chenar

                for (i = 0; i < w; i++)
                {
                    ims.SetPixel(i, 0, System.Drawing.Color.Blue);
                    ims.SetPixel(i, h - 1, System.Drawing.Color.Blue);
                }
                for (j = 0; j < h; j++)
                {
                    ims.SetPixel(0, j, System.Drawing.Color.Blue);
                    ims.SetPixel(w - 1, j, System.Drawing.Color.Blue);
                }
            }
        }
    }
    // --------------Sfarsit clasa osciloscop ------------------
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp134.jpg"></center>

<a name="fun"></a>

<ul><li><b> Utilizarea clasei "osciloscop" la afisarea diverselor functii matematice</b></ul>
&nbsp;&nbsp;&nbsp;&nbsp;Pentru a folosi clasa osciloscop la afisarea unei functii matematice oarecare, trebuie sa mai ajustam un pic clasa 
pentru a evita cazurile in care valoarea functiei depaseste dimensiunea unui Int16 si la conversia vlorii in Int16 in vederea afisarii grafice 
sa avem depasire. Vom folosi "System.OverflowException" pentru a determina daca val depaseste un Int16.
<br>&nbsp;&nbsp;&nbsp;&nbsp;Sa incercam sa afisam grafic functiile matematice f(x)=tg(x)*sin(x) si f(x)= sin(x) pe acelasi grafic.
<br>&nbsp;&nbsp;&nbsp;&nbsp;Daca stabilim domeniul in care apartine x ca fiind: [-6,6], pentru anumite valori functi tg(x) are valori infinite
insa captand eroarea  "System.OverflowException" vom evita mesaje de eroare prin setarea valorii la depasire, la valoarea maxima de exemplu.
<br>&nbsp;&nbsp;&nbsp;&nbsp;Tot ce trebuie sa facem pentru afisarea functiei e sa tabilim domeniul in care apartine x si valoarea maxima,
respectiv valoarea minima ce urmeaza a fi afisata pe grafic.
<br>&nbsp;&nbsp;&nbsp;&nbsp;definim deci
<xmp>
        osciloscop oscil_m;
        int n_maxx ; //numarul de puncte pe x
        int n_maxy ; //numarul de puncte pe y
        double val_max = 5; //valoarea maxima
        double val_min = -5; //valoarea minima
        double x0 = -6, x1 = 6;
        double[] valori = new double[0];
</xmp>
<br>&nbsp;&nbsp;&nbsp;&nbsp;Inaintea afisarii vom inscrie in vectorul valori, valorile ce urmeaza a fi afisate grafic cu o secventa de 
instructiuni de genul:
<xmp>
            double pas = (x1 - x0) / n_maxx;
            double x = x0;
            for (int i = 1; i <= n_maxx; i++)
            {
                x = x + pas;
                valori[i] = Math.Tan(x) * Math.Sin(x);
            }

</xmp>
<br>&nbsp;&nbsp;&nbsp;&nbsp;Dupa care sa afisam grafic valorile:
<xmp>
            oscil_m.sterg();
            oscil_m.auto_sx(x1, x0);
            oscil_m.setval(valori, n_maxx, Color.Red);
            oscil_m.display();
</xmp>
 
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_50_mat
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        System.Drawing.Graphics desen;
        public osciloscop oscil_m;
        int pozx = 10, pozy = 10, n_maxx = 400, n_maxy = 300;
        double val_max = 5; //valoarea maxima
        double val_min = -5; //valoarea minima
        double x0 = -6, x1 = 6;
        double[] valori = new double[0];
        double[] valoris = new double[0];
        private void Form1_Load(object sender, EventArgs e)
        {
            Array.Resize(ref valori, n_maxx + 1);
            Array.Resize(ref valoris, n_maxx + 1);
            desen = this.CreateGraphics();
            oscil_m = new osciloscop(desen, pozx, pozy, n_maxx, n_maxy, val_max, val_min);
        }

        private void Form1_Paint(object sender, PaintEventArgs e)
        {
            double pas = (x1 - x0) / n_maxx;
            double x = x0;
            for (int i = 1; i <= n_maxx; i++)
            {
                x = x + pas;
                valori[i] = Math.Tan(x) * Math.Sin(x);
                valoris[i] = Math.Sin(x);
            }
            oscil_m.sterg();
            oscil_m.auto_sx(x1, x0);
            oscil_m.setval(valori, n_maxx, Color.Red);
            oscil_m.setval(valoris, n_maxx, Color.Blue);
            oscil_m.display();
        }
    }
}

</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp140.jpg"></center><br><br>

<a name="uosc"></a>

<b><font color= "Blue" size=4> Utilizarea clasei <a href="../labs/osciloscop.txt">osciloscop</a></font></b>

<ul><li><b> Utilizarea clasei "osciloscop" pentru afisarea functiei (1-e<sup>x</sup>)*sin(k*x)</b></ul>

<br>&nbsp;&nbsp;&nbsp;&nbsp;Folosim acum clasa pentru a afisa o functie mai complexa cum ar fi: graficul functiei (1-e<sup>x</sup>)*sin(k*x)
pentru k apartine intervalului [0-15] si x apartine intervalului [0-1]
<br><br><center><img src="im_cpp133.jpg"></center><br>
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_19_ex
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        System.Drawing.Graphics desen;
        osciloscop instrum1;
        int pozx = 40, pozy = 80, n_maxx = 270, n_maxy = 200;
        double val_min = -100;
        double val_max = 100;
        double x0 = 0;
        double x1 = 1;
        double alfa = 0;
        double fi = 0;
        double[] valori = new double[0];
        private void Form1_Load(object sender, EventArgs e)
        {
            Array.Resize(ref valori, n_maxx + 1);
            desen = this.CreateGraphics();
            instrum1 = new osciloscop(desen, pozx, pozy, n_maxx, n_maxy, val_max, val_min);

        }

        private void Form1_Paint(object sender, PaintEventArgs e)
        {
            this.trackBar1.Maximum = System.Convert.ToInt16(val_max);
            this.trackBar1.Minimum = System.Convert.ToInt16(val_min);
            this.trackBar1.Value = 0;
            this.trackBar2.Maximum = n_maxy;
            this.trackBar2.Value = n_maxy / 3;
            this.trackBar3.Minimum = 1;
            this.trackBar3.Value = 15;
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            fi = fi + 0.1;
            alfa = fi;
            int transl = this.trackBar1.Value;
            int amplif = this.trackBar2.Value;
            double pas = (x1 - x0) / n_maxx;
            double x = x0;
            for (int i = 1; i <= n_maxx; i++)
            {
                x = x + pas;
                if (x > 1)
                    x = 0;
                int k = System.Convert.ToInt32(this.trackBar3.Value);
                valori[i] = transl + amplif * (Math.Sin(k * x + fi) * (1 - Math.Pow(Math.E, x)));
            }
            instrum1.sterg();
            instrum1.auto_sx(x1, x0);
            instrum1.setval(valori, n_maxx, Color.Magenta);
            instrum1.display();
        }
    }
}
</pre> </font>
</td></tr></table>

<ul><li><b> Utilizarea clasei "osciloscop" pentru a simula un ekg</b></ul>

<br>&nbsp;&nbsp;&nbsp;&nbsp;Revenim la aplicatia "achiz_v0" in care se afisa evolutia in timp a unui parametru
<br><br><center><img src="im_cpp95.gif"><img src="im_cpp59.gif"></center>

<br>&nbsp;&nbsp;&nbsp;&nbsp;Folosind clasa osciloscop, vom crea aplicatia "Oop_instr_19_ekg" pentru a simula un ekg:

<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_19_ekg
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public osciloscop ekg;
        int pozx = 40, pozy = 10, n_maxx = 300, n_maxy = 200;
        double val_max = 500, val_min=0 ;
        static double[] valori = new double[0];
        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            Array.Resize(ref valori, n_maxx + 1);
            ekg = new osciloscop(desen, pozx, pozy, n_maxx, n_maxy, val_max, val_min);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            double f = System.Convert.ToDouble(this.trackBar1.Value);
            for (int i = 0; i < n_maxx - 1; i++)
            {
                valori[i] = valori[i + 1];
            }
            valori[n_maxx - 1] = f;
            ekg.setval(valori, n_maxx, Color.Red);
        }
    }
 }
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp130.jpg"></center>
<br>&nbsp;&nbsp;&nbsp;&nbsp;Putem simula forma de unda a unui ekg folosind functii matematice. Vom realiza astfel aplicatia: <b> Oop_instr_19_ekg_s</b>
in care vom simula un ekg.
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_19_ekg_s
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public osciloscop ekg;
        int pozx = 100, pozy = 10, n_maxx = 500, n_maxy = 200;
        double val_max = 4, val_min = 0;
        static double[] valori = new double[0];
        double a_pwav = 0.25, d_pwav = 0.09, t_pwav = 0.16;
        double a_qwav = 0.025, d_qwav = 0.066, t_qwav = 0.166;
        double li = 0.5, a_qrswav = 1.6, d_qrswav = 0.09;
        double a_swav = 0.25, d_swav = 0.066, t_swav = 0.09;
        double a_twav = 0.35, d_twav = 0.142, t_twav = 0.2;
        double a_uwav = 0.035, d_uwav = 0.0476, t_uwav = 0.433;
        double p_wav(double x, double a_pwav, double d_pwav, double t_pwav, double li)
        {
            double l, a, b, p1, p2, harm1, pwav1, pwav;
            l = li;
            a = a_pwav;
            x = x + t_pwav;
            b = (2 * l) / d_pwav;
            int n = 100;
            p1 = 1 / l;
            p2 = 0;
            harm1 = 0.0;
            for (int i = 1; i < n; i++)
            {
                harm1 = (((Math.Sin((Math.PI / (2 * b)) * (b - (2 * i)))) / (b - (2 * i)) + (Math.Sin((Math.PI / (2 * b)) * (b + (2 * i)))) / (b + (2 * i))) * (2 / Math.PI)) * Math.Cos((i * Math.PI * x) / l);
                p2 = p2 + harm1;
            }
            pwav1 = p1 + p2;
            pwav = a * pwav1;
            return pwav;
        }
        double qrs_wav(double x, double a_qrswav, double d_qrswav, double li)
        {
            double l, a, b, harm, qrs1, qrs2, qrswav;
            l = li;
            a = a_qrswav;
            b = (2 * l) / d_qrswav;
            int n = 100;
            qrs1 = (a / (2 * b)) * (2 - b);
            qrs2 = 0;
            for (int i = 1; i < n; i++)
            {
                harm = (((2 * b * a) / (i * i * Math.PI * Math.PI)) * (1 - Math.Cos((i * Math.PI) / b))) * Math.Cos((i * Math.PI * x) / l);
                qrs2 = qrs2 + harm;
            }
            qrswav = qrs1 + qrs2;
            return qrswav;
        }
        double q_wav(double x, double a_qwav, double d_qwav, double t_qwav, double li)
        {
            double l, a, b, q1, q2, harm5, qwav;
            l = li;
            x = x + t_qwav;
            a = a_qwav;
            b = (2 * l) / d_qwav;
            int n = 100;
            q1 = (a / (2 * b)) * (2 - b);
            q2 = 0;
            for (int i = 1; i < n; i++)
            {
                harm5 = (((2 * b * a) / (i * i * Math.PI * Math.PI)) * (1 - Math.Cos((i * Math.PI) / b))) * Math.Cos((i * Math.PI * x) / l);
                q2 = q2 + harm5;
            }
            qwav = -1 * (q1 + q2);
            return qwav;
        }
        double s_wav(double x, double a_swav, double d_swav, double t_swav, double li)
        {
            double l, a, b, s1, s2, harm3, swav;
            l = li;
            x = x - t_swav;
            a = a_swav;
            b = (2 * l) / d_swav;
            int n = 100;
            s1 = (a / (2 * b)) * (2 - b);
            s2 = 0;
            for (int i = 1; i < n; i++)
            {
                harm3 = (((2 * b * a) / (i * i * Math.PI * Math.PI)) * (1 - Math.Cos((i * Math.PI) / b))) * Math.Cos((i * Math.PI * x) / l);
                s2 = s2 + harm3;
            }
            swav = -1 * (s1 + s2);
            return swav;
        }
        double t_wav(double x, double a_twav, double d_twav, double t_twav, double li)
        {
            double l, a, b, t1, t2, harm2, twav1, twav;
            l = li;
            a = a_twav;
            x = x - t_twav - 0.045;
            b = (2 * l) / d_twav;
            int n = 100;
            t1 = 1 / l;
            t2 = 0;
            for (int i = 1; i < n; i++)
            {
                harm2 = (((Math.Sin((Math.PI / (2 * b)) * (b - (2 * i)))) / (b - (2 * i)) + (Math.Sin((Math.PI / (2 * b)) * (b + (2 * i)))) / (b + (2 * i))) * (2 / Math.PI)) * Math.Cos((i * Math.PI * x) / l);
                t2 = t2 + harm2;
            }
            twav1 = t1 + t2;
            twav = a * twav1;
            return twav;
        }
        double u_wav(double x, double a_uwav, double d_uwav, double t_uwav, double li)
        {
            double l, a, b, u1, u2, harm4, uwav1, uwav;
            l = li;
            a = a_uwav;
            x = x - t_uwav;
            b = (2 * l) / d_uwav;
            int n = 100;
            u1 = 1 / l;
            u2 = 0;
            for (int i = 1; i < n; i++)
            {
                harm4 = (((Math.Sin((Math.PI / (2 * b)) * (b - (2 * i)))) / (b - (2 * i)) + (Math.Sin((Math.PI / (2 * b)) * (b + (2 * i)))) / (b + (2 * i))) * (2 / Math.PI)) * Math.Cos((i * Math.PI * x) / l);
                u2 = u2 + harm4;
            }
            uwav1 = u1 + u2;
            uwav = a * uwav1;
            return uwav;
        }
        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            Array.Resize(ref valori, n_maxx + 1);
            ekg = new osciloscop(desen, pozx, pozy, n_maxx, n_maxy, val_max, val_min);

        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            int p;
            a_qrswav = System.Convert.ToDouble(this.trackBar2.Value) / 10.0;
            double val_m = System.Convert.ToDouble(this.trackBar1.Value);
            li = 30.0 / val_m;
            this.label1.Text = Math.Round(val_m).ToString();
            double pas = 0.004;
            double x = pas;
            double pwav, qwav, qrswav, swav, twav, uwav, ecg;
            for (p = 0; p < n_maxx; p++)
            {
                pwav = p_wav(x, a_pwav, d_pwav, t_pwav, li);
                qwav = q_wav(x, a_qwav, d_qwav, t_qwav, li);
                qrswav = qrs_wav(x, a_qrswav, d_qrswav, li);
                swav = s_wav(x, a_swav, d_swav, t_swav, li);
                twav = t_wav(x, a_twav, d_twav, t_twav, li);
                uwav = u_wav(x, a_uwav, d_uwav, t_uwav, li);
                ecg = pwav + qrswav + twav + swav + qwav + uwav;
                valori[p] = ecg;
                x = x + pas;
            }
            double min = valori[0];
            for (p = 0; p < n_maxx; p++)
            {
                if (valori[p] < min)
                    min = valori[p];
            }
            for (p = 0; p < n_maxx; p++)
            {
                valori[p] = valori[p] - min + 0.5; // 0.5 translatie pe y
            }
            ekg.sterg();
            if (this.checkBox1.Checked)
                ekg.auto_sx(pas * n_maxx, 0);
            else
                ekg.auto_sx(n_maxx, 0);

            ekg.setval(valori, n_maxx, Color.Red);
            ekg.display();</pre> </font>
        }
    }
}
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp139.jpg"></center>
<ul><li><b> Utilizarea clasei "osciloscop" pentru a afisa forma de unda a tensiunii trifazate</b></ul>
&nbsp;&nbsp;&nbsp;&nbsp;Vom folosi acum clasa <b> osciloscop </b> nou creata pentru a afisa forma de unda a tensiunii trifazate.
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_50_rst
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        public osciloscop oscil_m;
        int pozx = 40, pozy = 10, n_maxx = 400, n_maxy = 200;
        double val_max = 1.2, val_min = -1.2;
        static double[] valori1 = new double[0];
        static double[] valori2 = new double[0];
        static double[] valori3 = new double[0];
        private void Form1_Load(object sender, EventArgs e)
        {
            desen = this.CreateGraphics();
            Array.Resize(ref valori1, n_maxx + 1);
            Array.Resize(ref valori2, n_maxx + 1);
            Array.Resize(ref valori3, n_maxx + 1);
            oscil_m = new osciloscop(desen, pozx, pozy, n_maxx, n_maxy, val_max, val_min);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            double fi1 = this.trackBar1.Value / 100.0;
            double fi2 = this.trackBar2.Value / 100.0;
            double alfa = 0;
            double pas = 0.05;
            for (int i = 1; i <= n_maxx; i++)
            {
                alfa += pas;
                valori1[i] = Math.Sin(alfa);
                valori2[i] = Math.Sin(alfa - fi1);
                valori3[i] = Math.Sin(alfa - fi2);
            }
            oscil_m.sterg();
            oscil_m.auto_sx(pas * n_maxx, 0);
            oscil_m.setval(valori1, n_maxx, Color.Red);
            oscil_m.setval(valori2, n_maxx, Color.Green);
            oscil_m.setval(valori3, n_maxx, Color.Magenta);
            oscil_m.display();
        }
    }
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp135.jpg"></center>

<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Vom folosi aceeai clasa <b> osciloscop </b> pentru a afisa formele de unda ale unui regultor PI.
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace Oop_instr_50_pi
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public System.Drawing.Graphics desen;
        //public System.Drawing.Pen creion_rosu;
        public osciloscop oscil_m;
        int pozx = 180, pozy = 10, n_maxx = 400, n_maxy = 300;
        double r, er, ir, e_v, u, u_v, y, y_v, kp, ikp, Ti, iTi, Te;
        double val_max = 800; //valoarea maxima
        double val_min = -100; //valoarea minima
        static double[] valori_0 = new double[0];
        static double[] valori_1 = new double[0];
        private void Form1_Load(object sender, EventArgs e)
        {
            Array.Resize(ref valori_0, n_maxx + 1);
            Array.Resize(ref valori_1, n_maxx + 1);
            desen = this.CreateGraphics();
            //creion_rosu = new System.Drawing.Pen(System.Drawing.Color.Red);
            oscil_m = new osciloscop(desen, pozx, pozy, n_maxx, n_maxy, val_max, val_min);
            kp = 1.1;
            Ti = 2.5;
            Te = 0.1;
            r = 175;
            u = 50;
            y = 0;
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            y = 0;
            u = 50;
            e_v = 0;
            y_v = 0;
            u_v = 0;
            ir = System.Convert.ToInt32(this.trackBar1.Value);
            ikp = System.Convert.ToDouble(this.trackBar2.Value);
            iTi = System.Convert.ToInt32(this.trackBar3.Value);
            r = System.Convert.ToDouble(ir);
            kp = System.Convert.ToDouble(ikp / 10);
            Ti = System.Convert.ToDouble(iTi / 10);
            this.label4.Text = r.ToString();
            this.label5.Text = kp.ToString();
            this.label6.Text = Ti.ToString();
            for (int i = 1; i <= n_maxx; i++)
            {
                er = r - y;
                u = u_v + er * (kp + (Ti * (Te / 2))) + e_v * ((Ti * (Te / 2)) - kp);
                y = (u * Te + 5 * y_v) / (5 + Te);
                valori_0[i] = y;
                valori_1[i] = u;
                e_v = er;
                y_v = y;
                u_v = u;
            }
            oscil_m.sterg();
            oscil_m.setval(valori_0, n_maxx, Color.Red);
            oscil_m.setval(valori_1, n_maxx, Color.Green);
            oscil_m.display();
        }
    }
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp136.jpg"></center>
<br><br><a name="a_xy"></a>
<!--<font color= "Red" size=5>Instrumente virtuale pentru afisarea in coordonate x-y a marimilor electrice </font>

<!------------------------------------------------------------------->
<!--<br><br> Pornim de la aplicatia C# <b><font color="red">"Oop_instr_30" </b></font> In care se defineste clasa <b>afisor_xy</b> pentru fisarea grafica
in coordonate x-y.-->

<a name="bin"></a>
<font color= "Red" size=5>Instrumente virtuale pentru valori binare</font>
<a name="bin_virt"></a>
<br><br><li><font color= "Blue" size=4> Instrument virtual - binar </font>

<br><br>Aplicatia C# <font color="red"><b>"oop_08" </b></font> foloseste clasa <b> binar </b>  pentru a afisa grafic 
valori binare.

<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Vom creea o clasa denumita "binar" dupa care vom realiza trei obiecte prin instantierea clasei binar.

<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace oop_08
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        System.Drawing.Graphics Desen;
        System.Drawing.Pen Creion_rosu;
        System.Drawing.SolidBrush Pens_blu;
        System.Drawing.SolidBrush Pens_back;
        public binar binar1;
        public binar binar2;
        public binar binar3;
        System.Random nr;
        UInt64 num;

        public class binar
        {
            int x0;
            int y0;
            int w;
            int h;


            public void setval(int nrb, UInt64 n, System.Drawing.Graphics zona_des, System.Drawing.Pen creion, System.Drawing.SolidBrush pens_albastra, System.Drawing.SolidBrush radiera)
            {

                int wb = w / (3 * nrb);
                int hb = h / 3;
                int x = x0 + w - 3 * wb;
                int y = y0 + hb;
                int i;
                zona_des.DrawRectangle(creion, x0, y0, w, h);
                for (i = nrb - 1; i >= 0; i--)
                {
                    System.UInt64 bit = ((n >> (nrb - i - 1)) & 1);
                    zona_des.DrawRectangle(creion, x - 1, y - 1, wb + 1, hb + 1);
                    if (bit == 1)
                        zona_des.FillRectangle(pens_albastra, x, y, wb, hb);
                    else
                        zona_des.FillRectangle(radiera, x, y, wb, hb);

                    x -= 3 * wb;

                }
            }
            public void init_binar(int pozx, int pozy, int lat, int inalt)
            {
                x0 = pozx;
                y0 = pozy;
                w = lat;
                h = inalt;
            }
        }
        private void Form1_Load(object sender, EventArgs e)
        {
            Creion_rosu = new System.Drawing.Pen(System.Drawing.Color.Red);
            Pens_blu = new System.Drawing.SolidBrush(System.Drawing.Color.Blue);
            Pens_back = new System.Drawing.SolidBrush(this.BackColor);
            Desen = this.CreateGraphics();
            nr = new System.Random();
            binar1 = new binar();
            binar1.init_binar(50, 10, 400, 20);
            binar2 = new binar();
            binar2.init_binar(10, 75, 300, 30);
            binar3 = new binar();
            binar3.init_binar(200, 150, 200, 40);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            binar1.setval(32, System.Convert.ToUInt64(nr.Next(1999999999)), Desen, Creion_rosu, Pens_blu, Pens_back);
            binar2.setval(16, num, Desen, Creion_rosu, Pens_blu, Pens_back);
            binar3.setval(8, System.Convert.ToUInt64(nr.Next(255)), Desen, Creion_rosu, Pens_blu, Pens_back);
            num += 1;
            if (num > 256 * 256)
                num = 0;
        }
    }
}
</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp30.jpg"></center><br>
<!------------------------------------------------------------------->

<a name="matrix"></a>
<br><br><li><font color= "Blue" size=4> Instrument virtual - matrice binara </font>

<br><br>Aplicatia C# <font color="red"><b>"oop_08" </b></font> foloseste clasa <b> matrix </b>  pentru a afisa matricea binara.

<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>
namespace oop_12
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        System.Drawing.Graphics Desen;
        System.Drawing.Pen Creion_rosu;
        System.Drawing.SolidBrush Pens_blu;
        System.Drawing.SolidBrush Pens_back;
        System.Random nr;
        public matrix matrix1;
        static Int64[] num = new Int64[0];
        int biti = 8, rnd=10;
        private void Form1_Load(object sender, EventArgs e)
        {
            Creion_rosu = new System.Drawing.Pen(System.Drawing.Color.Red);
            Pens_blu = new System.Drawing.SolidBrush(System.Drawing.Color.Blue);
            Pens_back = new System.Drawing.SolidBrush(this.BackColor);
            Desen = this.CreateGraphics();
            nr = new System.Random();
            Array.Resize(ref num, rnd + 1);
            matrix1 = new matrix(50, 50, 400, 20);
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            matrix1.setval(biti, rnd,num, Desen, Creion_rosu, Pens_blu, Pens_back);
            this.timer1.Interval = 50;
            /*
            for(int j=0; j < rnd; j++){
                num[j]++;
                if (num[j] > 256)
                    num[j] = 0;
                }
             */
             for(int j=0; j < rnd; j++){
                num[j]=System.Convert.ToInt64(nr.Next(255));
             }
        }
    }
    public class matrix
    {
        int x0;
        int y0;
        int w;
        int h;
        public void setval(int nrb, int nrr, Int64[] n, System.Drawing.Graphics zona_des, System.Drawing.Pen creion, System.Drawing.SolidBrush pens_albastra, System.Drawing.SolidBrush radiera)
        {
            int wb = w / (3 * nrb);
            int hb = h / 3;
            int x = x0 + w - 3 * wb;
            int y = y0 + hb;
            int i,j;
            zona_des.DrawRectangle(creion, x0, y0, w, h*(nrr-1));
            for (j = 0; j < nrr; j++)
            {
                for (i = nrb - 1; i >= 0; i--)
                {
                    System.Int64 bit = ((n[j] >> (nrb - i - 1)) & 1);
                    zona_des.DrawRectangle(creion, x - 1, y - 1, wb + 1, hb + 1);
                    if (bit == 1)
                        zona_des.FillRectangle(pens_albastra, x, y, wb, hb);
                    else
                        zona_des.FillRectangle(radiera, x, y, wb, hb);

                    x -= 3 * wb;
                }
                x = x0 + w - 3 * wb;
                y += 3 * hb;
            }
        }
        public matrix(int pozx, int pozy, int lat, int inalt)
        {
            x0 = pozx;
            y0 = pozy;
            w = lat;
            h = inalt;
        }
    }
}

</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
<br><br><center><img src="im_cpp31.jpg"></center><br>


<!------------------------------------------------------------------->
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br><br><!------------------------------------------------------------------->
<table width="100%" border=1><tr><td bgcolor="WhiteSmoke">
<font size="3" color="DarkBlue"><pre>

</pre> </font>
</td></tr></table>
<!------------------------------------------------------------------->
</body>
</html>